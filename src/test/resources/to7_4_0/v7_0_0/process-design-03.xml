<?xml version="1.0" encoding="UTF-8"?>
<processDefinition xmlns="http://www.bonitasoft.org/ns/process/client/6.3" bos_version="6.0-SNAPSHOT" description="" displayDescription="" name="DPerm-PJ-ECHUE-Traitement" version="1.1.0">
  <stringIndexes>
    <stringIndex index="1"/>
    <stringIndex index="2"/>
    <stringIndex index="3"/>
    <stringIndex index="4"/>
    <stringIndex index="5"/>
  </stringIndexes>
  <flowElements>
    <transitions>
      <transition id="858423549146412443" name="Traitement ?_-&gt;_traiter TRAITEMENT_MET_TRAITER_MANUELLE" source="-7650460117796767812" target="-4876116241108304857">
        <condition expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="codeSortieTraiter" returnType="java.lang.Boolean" id="6603985956614419205">
          <content>codeSortie == "Valider"</content>
          <expression expressionType="TYPE_VARIABLE" name="codeSortie" returnType="java.lang.String" id="5649197577961008435">
            <content>codeSortie</content>
          </expression>
        </condition>
      </transition>
      <transition id="5283198878804168443" name="Demander Attribution tâche métier_-&gt;_RecevoirAttributionMetier" source="-8456718405810970300" target="-8383969093528301277"/>
      <transition id="1013255267931435607" name="RecevoirAttributionMetier_-&gt;_Recevoir attribution" source="-8383969093528301277" target="-6053231319704948221"/>
      <transition id="129716143845886862" name="Début traitement_-&gt;_Demander Attribution tâche métier" source="-4837761989316226414" target="-8456718405810970300"/>
      <transition id="8036266156305369193" name="Déterminer attribution métier_-&gt;_HistorisationAttribution" source="-8932868884221801937" target="-7390150140642673981"/>
      <transition id="3466313570673145685" name="HistorisationAttribution_-&gt;_Traitement PJ-ECHUE" source="-7390150140642673981" target="-7743557457123206908"/>
      <transition id="7907783763855819426" name="Traitement ?_-&gt;_Cloture TRAITEMENT_MET_DOCUMENT_TAXE" source="-7650460117796767812" target="-7661396262429067357"/>
      <transition id="2299557142480111676" name="Cloture TRAITEMENT_MET_DOCUMENT_TAXE_-&gt;_Fin cloture" source="-7661396262429067357" target="-8839777733939990055"/>
      <transition id="3392752396061618272" name="Recevoir attribution_-&gt;_Déterminer attribution métier" source="-6053231319704948221" target="-8932868884221801937"/>
      <transition id="2882242925358501384" name="traiter TRAITEMENT_MET_TRAITER_MANUELLE_-&gt;_Fin traité" source="-4876116241108304857" target="-5255675401303113632"/>
      <transition id="6371906930711968907" name="Traitement PJ-ECHUE_-&gt;_Traitement ?" source="-7743557457123206908" target="-7650460117796767812"/>
    </transitions>
    <connectors/>
    <dataDefinitions>
      <textDataDefinition className="java.lang.String" longText="true" name="groupeCandidatTraitement" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="npa" transient="false"/>
      <dataDefinition className="java.lang.Integer" name="numeroTiers" transient="false"/>
      <dataDefinition className="java.lang.Integer" name="periodeFiscale" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="actionFin" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="codeSortie" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="motifSortie" transient="false"/>
      <dataDefinition className="java.util.Date" name="dateReceptionDocument" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="documentType" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="documentSousType" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="typeImpot" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="messageCorrelationId" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="identifiantSupervision" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="lastMessageContent" transient="false"/>
      <dataDefinition className="java.lang.Boolean" name="traitementMetier" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="visaDossierReserve" transient="false"/>
      <dataDefinition className="java.lang.Float" name="poidsTacheTraitementMetier" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="typeTacheTraitementMetier" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="pays" transient="false"/>
      <dataDefinition className="java.lang.Long" name="utilisateurTraitementMetierId" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="documentContentUrl" transient="false"/>
      <dataDefinition className="java.lang.Long" name="numeroAVS13" transient="false"/>
      <dataDefinition className="java.util.Date" name="dateDeterminante" transient="false"/>
      <dataDefinition className="java.util.Date" name="horodatage" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="etatTaxation" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="identifiantTache" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="actionAbandon" transient="false"/>
      <dataDefinition className="java.lang.Long" name="idTacheMetier" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="nomPrenoms" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="regleAttribution" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="bamProcessInstanceId" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="bamProcessDefinitionId" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="visaUtilisateurTache" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="note" transient="false"/>
      <dataDefinition className="ch.vd.bpm.dperm.beans.IdentifiantArchivage" name="identifiantArchiveXMLUnitaire" transient="false"/>
      <dataDefinition className="java.lang.Long" name="traitementDiTaskBusinessId" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="support" transient="false"/>
      <dataDefinition className="java.lang.Integer" name="dateNaissance" transient="false"/>
      <dataDefinition className="java.lang.Integer" name="numeroOid" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="typeAssujettissement" transient="false"/>
      <dataDefinition className="java.lang.Integer" name="dateDeces" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="typeTaxation" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="codeSegment" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="visaPreferentiel" transient="false"/>
      <dataDefinition className="java.lang.Boolean" name="controleIA" transient="false"/>
      <textDataDefinition className="java.lang.String" longText="true" name="doublonTypeTaxationPrecedente" transient="false"/>
      <dataDefinition className="java.lang.Boolean" name="assujettissement360" transient="false"/>
      <dataDefinition className="java.lang.Boolean" name="contribuableSourcierMixte" transient="false"/>
      <dataDefinition className="java.lang.Boolean" name="releveFiscalBancaire" transient="false"/>
    </dataDefinitions>
    <documentDefinitions/>
    <flowNodes>
      <userTask actorName="Taxateur DI" description="Traitement PJ-ECHUE" expectedDuration="3600000" id="-7743557457123206908" name="Traitement PJ-ECHUE" priority="NORMAL">
        <displayDescription expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="description" returnType="java.lang.String" id="5163138606214855773">
          <content>numeroTiers+"/"+periodeFiscale+"/"+nomPrenoms</content>
          <expression expressionType="TYPE_VARIABLE" name="nomPrenoms" returnType="java.lang.String" id="5697007981653806256">
            <content>nomPrenoms</content>
          </expression>
          <expression expressionType="TYPE_VARIABLE" name="numeroTiers" returnType="java.lang.Integer" id="8370854330660141233">
            <content>numeroTiers</content>
          </expression>
          <expression expressionType="TYPE_VARIABLE" name="periodeFiscale" returnType="java.lang.Integer" id="5187049552531876879">
            <content>periodeFiscale</content>
          </expression>
        </displayDescription>
        <incomingTransition idref="3466313570673145685"/>
        <outgoingTransition idref="6371906930711968907"/>
        <connector activationEvent="ON_ENTER" connectorId="scripting-groovy" failAction="FAIL" name="setAssigneeIfAvailable" version="1.0.0">
          <inputs>
            <input name="script">
              <expression expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="setAssignee" returnType="java.lang.Object" id="6982437443174758675">
                <content>import java.util.logging.Logger;

if(utilisateurTraitementMetierId) {
	try {
		apiAccessor.getProcessAPI().assignUserTask(activityInstanceId, utilisateurTraitementMetierId)
	} catch (org.bonitasoft.engine.identity.UserNotFoundException ex) {
		Logger.getAnonymousLogger().info("user "+utilisateurTraitementMetierId+" not found.")
	}
}</content>
                <expression expressionType="TYPE_ENGINE_CONSTANT" interpreter="" name="apiAccessor" returnType="com.bonitasoft.engine.api.APIAccessor" id="7701323068030062004">
                  <content>apiAccessor</content>
                </expression>
                <expression expressionType="TYPE_ENGINE_CONSTANT" interpreter="" name="activityInstanceId" returnType="java.lang.Long" id="8430831557997483281">
                  <content>activityInstanceId</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="utilisateurTraitementMetierId" returnType="java.lang.Long" id="5816606817745143303">
                  <content>utilisateurTraitementMetierId</content>
                </expression>
              </expression>
            </input>
          </inputs>
          <outputs/>
        </connector>
        <connector activationEvent="ON_ENTER" connectorId="EvtTacheDperm" failAction="FAIL" name="creationTache" version="1.2.0">
          <inputs>
            <input name="jmsConnectionFactory">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="java:comp/env/activemq" returnType="java.lang.String" id="8870724262825552266">
                <content>java:comp/env/activemq</content>
              </expression>
            </input>
            <input name="esbApplication">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="esbNomApplication" returnType="java.lang.String" id="8954591232037948199">
                <content>esbNomApplication</content>
              </expression>
            </input>
            <input name="numeroTiers">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="numeroTiers" returnType="java.lang.Integer" id="7424457395957603454">
                <content>numeroTiers</content>
              </expression>
            </input>
            <input name="identifiantSupervision">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="identifiantSupervision" returnType="java.lang.String" id="9123643973648247287">
                <content>identifiantSupervision</content>
              </expression>
            </input>
            <input name="actionTache">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="CREATION" returnType="java.lang.String" id="8797605543575618104">
                <content>CREATION</content>
              </expression>
            </input>
            <input name="esbDomaine">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="esbNomDomaine" returnType="java.lang.String" id="6945816425061919819">
                <content>esbNomDomaine</content>
              </expression>
            </input>
            <input name="sousTypeDocument">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="documentSousType" returnType="java.lang.String" id="9007546010949330131">
                <content>documentSousType</content>
              </expression>
            </input>
            <input name="periodeFiscale">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="periodeFiscale" returnType="java.lang.Integer" id="5048164023501672691">
                <content>periodeFiscale</content>
              </expression>
            </input>
            <input name="numeroOid">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="numeroOid" returnType="java.lang.Integer" id="4939368487446396127">
                <content>numeroOid</content>
              </expression>
            </input>
            <input name="typeTache">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="typeTache" returnType="java.lang.String" id="6385382716507936975">
                <content>typeTache</content>
              </expression>
            </input>
            <input name="codeApplication">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="BPMS" returnType="java.lang.String" id="7217793241224182124">
                <content>BPMS</content>
              </expression>
            </input>
            <input name="numeroAvs13">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="numeroAVS13" returnType="java.lang.Long" id="6909825919800698156">
                <content>numeroAVS13</content>
              </expression>
            </input>
            <input name="identifiantTache">
              <expression expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="idTacheMetier" returnType="java.lang.Long" id="6066680781756303613">
                <content>activityInstanceId</content>
                <expression expressionType="TYPE_ENGINE_CONSTANT" interpreter="" name="activityInstanceId" returnType="java.lang.Long" id="5252724209970987491">
                  <content>activityInstanceId</content>
                </expression>
              </expression>
            </input>
            <input name="esbDestinationHistorique">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="integrerKpiDossierPermanent" returnType="java.lang.String" id="8793858285022543982">
                <content>integrerKpiDossierPermanent</content>
              </expression>
            </input>
            <input name="typeDocument">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="documentType" returnType="java.lang.String" id="7385799892069107954">
                <content>documentType</content>
              </expression>
            </input>
            <input name="nomPrenom">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="nomPrenoms" returnType="java.lang.String" id="6204180648297336416">
                <content>nomPrenoms</content>
              </expression>
            </input>
            <input name="visaUtilisateurSource">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="visaUtilisateurSource" returnType="java.lang.String" id="9177507713814286168">
                <content>visaUtilisateurSource</content>
              </expression>
            </input>
            <input name="horodatageReception">
              <expression expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="dateReceptionMs" returnType="java.lang.Long" id="5861861917424119500">
                <content>dateReceptionDocument != null ? dateReceptionDocument.getTime() : null</content>
                <expression expressionType="TYPE_VARIABLE" name="dateReceptionDocument" returnType="java.util.Date" id="7626593414133942132">
                  <content>dateReceptionDocument</content>
                </expression>
              </expression>
            </input>
            <input name="note">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="noteContenu" returnType="java.lang.String" id="7551720287763107512">
                <content>noteContenu</content>
              </expression>
            </input>
          </inputs>
          <outputs/>
        </connector>
        <connector activationEvent="ON_ENTER" connectorId="EvtTacheDperm" failAction="FAIL" name="HistoAttributionPjEchue" version="1.2.0">
          <inputs>
            <input name="jmsConnectionFactory">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="java:comp/env/activemq" returnType="java.lang.String" id="6511101603047923754">
                <content>java:comp/env/activemq</content>
              </expression>
            </input>
            <input name="esbApplication">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="esbNomApplication" returnType="java.lang.String" id="7671971414695206051">
                <content>esbNomApplication</content>
              </expression>
            </input>
            <input name="identifiantSupervision">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="identifiantSupervision" returnType="java.lang.String" id="6145720671983259775">
                <content>identifiantSupervision</content>
              </expression>
            </input>
            <input name="numeroTiers">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="numeroTiers" returnType="java.lang.Integer" id="7816347747034513115">
                <content>numeroTiers</content>
              </expression>
            </input>
            <input name="visaUtilisateurCible">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="visaUtilisateurTache" returnType="java.lang.String" id="7045921623748652199">
                <content>visaUtilisateurTache</content>
              </expression>
            </input>
            <input name="actionTache">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="ATTRIBUTION" returnType="java.lang.String" id="7894127219752162986">
                <content>ATTRIBUTION</content>
              </expression>
            </input>
            <input name="esbDomaine">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="esbNomDomaine" returnType="java.lang.String" id="8904458102825216614">
                <content>esbNomDomaine</content>
              </expression>
            </input>
            <input name="sousTypeDocument">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="documentSousType" returnType="java.lang.String" id="8930222666021671877">
                <content>documentSousType</content>
              </expression>
            </input>
            <input name="periodeFiscale">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="periodeFiscale" returnType="java.lang.Integer" id="9202507335042124369">
                <content>periodeFiscale</content>
              </expression>
            </input>
            <input name="numeroOid">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="numeroOid" returnType="java.lang.Integer" id="8477789725454123721">
                <content>numeroOid</content>
              </expression>
            </input>
            <input name="typeTache">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="typeTacheTraitementMetier" returnType="java.lang.String" id="6102967610378638761">
                <content>typeTacheTraitementMetier</content>
              </expression>
            </input>
            <input name="codeApplication">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="BPMS" returnType="java.lang.String" id="4757656261996246509">
                <content>BPMS</content>
              </expression>
            </input>
            <input name="numeroAvs13">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="numeroAVS13" returnType="java.lang.Long" id="6077455859794338967">
                <content>numeroAVS13</content>
              </expression>
            </input>
            <input name="identifiantTache">
              <expression expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="idTacheMetier" returnType="java.lang.Long" id="5297164916592805334">
                <content>activityInstanceId</content>
                <expression expressionType="TYPE_ENGINE_CONSTANT" interpreter="" name="activityInstanceId" returnType="java.lang.Long" id="6054580624784986025">
                  <content>activityInstanceId</content>
                </expression>
              </expression>
            </input>
            <input name="esbDestinationHistorique">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="integrerKpiDossierPermanent" returnType="java.lang.String" id="9133375411451924624">
                <content>integrerKpiDossierPermanent</content>
              </expression>
            </input>
            <input name="typeDocument">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="documentType" returnType="java.lang.String" id="6975614853388410438">
                <content>documentType</content>
              </expression>
            </input>
            <input name="nomPrenom">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="nomPrenoms" returnType="java.lang.String" id="6235174566280675481">
                <content>nomPrenoms</content>
              </expression>
            </input>
            <input name="visaUtilisateurSource">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="visaUtilisateurSource" returnType="java.lang.String" id="6822375551229951323">
                <content>visaUtilisateurSource</content>
              </expression>
            </input>
            <input name="horodatageReception">
              <expression expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="dateMs" returnType="java.lang.Long" id="9134571316763964594">
                <content>dateReceptionDocument != null ? dateReceptionDocument.getTime() : null</content>
                <expression expressionType="TYPE_VARIABLE" name="dateReceptionDocument" returnType="java.util.Date" id="7210166619583528289">
                  <content>dateReceptionDocument</content>
                </expression>
              </expression>
            </input>
            <input name="codePotCible">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="groupeCandidatTraitement" returnType="java.lang.String" id="5856096979346831249">
                <content>groupeCandidatTraitement</content>
              </expression>
            </input>
            <input name="note">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="noteContenu" returnType="java.lang.String" id="8547727941193623596">
                <content>noteContenu</content>
              </expression>
            </input>
          </inputs>
          <outputs/>
        </connector>
        <connector activationEvent="ON_FINISH" connectorId="HumanTaskRemoveIndex" failAction="FAIL" name="unindex" version="1.0.0">
          <inputs/>
          <outputs/>
        </connector>
        <connector activationEvent="ON_ENTER" connectorId="humanTaskAddToIndex" failAction="FAIL" name="index" version="1.1.0">
          <inputs>
            <input name="taskDataNames">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="dateReception,groupeCandidat,hasNote,poidsTache,taskAssigned,taskRead,typeTache,nomPrenomsFiltered,noteContenu,etapeManuelle" returnType="java.lang.String" id="4710817451457892285">
                <content>dateReception,groupeCandidat,hasNote,poidsTache,taskAssigned,taskRead,typeTache,nomPrenomsFiltered,noteContenu,etapeManuelle</content>
              </expression>
            </input>
            <input name="processDataNames">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="dateNaissance,identifiantSupervision,nomPrenoms,npa,numeroTiers,pays,periodeFiscale,documentSousType,documentType,numeroAVS13,numeroOid" returnType="java.lang.String" id="6637908168014366965">
                <content>dateNaissance,identifiantSupervision,nomPrenoms,npa,numeroTiers,pays,periodeFiscale,documentSousType,documentType,numeroAVS13,numeroOid</content>
              </expression>
            </input>
          </inputs>
          <outputs/>
        </connector>
        <connector activationEvent="ON_FINISH" connectorId="EvtTacheDperm" failAction="FAIL" name="HistoClotureManuelle" version="1.2.0">
          <inputs>
            <input name="jmsConnectionFactory">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="java:comp/env/activemq" returnType="java.lang.String" id="7269205293585659409">
                <content>java:comp/env/activemq</content>
              </expression>
            </input>
            <input name="esbApplication">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="esbNomApplication" returnType="java.lang.String" id="4927085157810710589">
                <content>esbNomApplication</content>
              </expression>
            </input>
            <input name="numeroTiers">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="numeroTiers" returnType="java.lang.Integer" id="6180579238792958414">
                <content>numeroTiers</content>
              </expression>
            </input>
            <input name="identifiantSupervision">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="identifiantSupervision" returnType="java.lang.String" id="6900850730080936611">
                <content>identifiantSupervision</content>
              </expression>
            </input>
            <input name="actionTache">
              <expression expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="CLOTURE" returnType="java.lang.String" id="8173256290072677274">
                <content>if(codeSortie=="Traiter") return "TRAITEMENT"

else return "CLOTURE"</content>
                <expression expressionType="TYPE_VARIABLE" name="codeSortie" returnType="java.lang.String" id="8401158224513246227">
                  <content>codeSortie</content>
                </expression>
              </expression>
            </input>
            <input name="esbDomaine">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="esbNomDomaine" returnType="java.lang.String" id="8321846029363351549">
                <content>esbNomDomaine</content>
              </expression>
            </input>
            <input name="sousTypeDocument">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="documentSousType" returnType="java.lang.String" id="8072997274071955842">
                <content>documentSousType</content>
              </expression>
            </input>
            <input name="periodeFiscale">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="periodeFiscale" returnType="java.lang.Integer" id="6858560323647432674">
                <content>periodeFiscale</content>
              </expression>
            </input>
            <input name="numeroOid">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="numeroOid" returnType="java.lang.Integer" id="8656504386887013261">
                <content>numeroOid</content>
              </expression>
            </input>
            <input name="typeTache">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="typeTacheTraitementMetier" returnType="java.lang.String" id="4784274251412296333">
                <content>typeTacheTraitementMetier</content>
              </expression>
            </input>
            <input name="codeApplication">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="BPMS" returnType="java.lang.String" id="6871125537217970667">
                <content>BPMS</content>
              </expression>
            </input>
            <input name="numeroAvs13">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="numeroAVS13" returnType="java.lang.Long" id="7411416686180246018">
                <content>numeroAVS13</content>
              </expression>
            </input>
            <input name="identifiantTache">
              <expression expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="idTacheMetier" returnType="java.lang.Long" id="8827675622929502907">
                <content>activityInstanceId</content>
                <expression expressionType="TYPE_ENGINE_CONSTANT" interpreter="" name="activityInstanceId" returnType="java.lang.Long" id="5773789557896034858">
                  <content>activityInstanceId</content>
                </expression>
              </expression>
            </input>
            <input name="esbDestinationHistorique">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="integrerKpiDossierPermanent" returnType="java.lang.String" id="9200019548090354373">
                <content>integrerKpiDossierPermanent</content>
              </expression>
            </input>
            <input name="typeDocument">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="documentType" returnType="java.lang.String" id="7499740441134965038">
                <content>documentType</content>
              </expression>
            </input>
            <input name="nomPrenom">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="nomPrenoms" returnType="java.lang.String" id="6011040986309808487">
                <content>nomPrenoms</content>
              </expression>
            </input>
            <input name="visaUtilisateurSource">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="visaUtilisateurTache" returnType="java.lang.String" id="7815447048304577267">
                <content>visaUtilisateurTache</content>
              </expression>
            </input>
            <input name="horodatageReception">
              <expression expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="dateReceptionMs" returnType="java.lang.Long" id="5446252374163810773">
                <content>dateReceptionDocument != null ? dateReceptionDocument.getTime() : null</content>
                <expression expressionType="TYPE_VARIABLE" name="dateReceptionDocument" returnType="java.util.Date" id="8657051427663886883">
                  <content>dateReceptionDocument</content>
                </expression>
              </expression>
            </input>
            <input name="note">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="noteContenu" returnType="java.lang.String" id="5487139582275411588">
                <content>noteContenu</content>
              </expression>
            </input>
          </inputs>
          <outputs/>
        </connector>
        <dataDefinitions>
          <dataDefinition className="java.lang.Boolean" name="taskRead" transient="false">
            <defaultValue expressionType="TYPE_CONSTANT" interpreter="" name="false" returnType="java.lang.Boolean" id="8940421675658265359">
              <content>false</content>
            </defaultValue>
          </dataDefinition>
          <textDataDefinition className="java.lang.String" longText="true" name="typeTache" transient="false">
            <defaultValue expressionType="TYPE_VARIABLE" interpreter="" name="typeTacheTraitementMetier" returnType="java.lang.String" id="4935421767767320819">
              <content>typeTacheTraitementMetier</content>
            </defaultValue>
          </textDataDefinition>
          <textDataDefinition className="java.lang.String" longText="true" name="groupeCandidat" transient="false">
            <defaultValue expressionType="TYPE_VARIABLE" interpreter="" name="groupeCandidatTraitement" returnType="java.lang.String" id="5936050103955415454">
              <content>groupeCandidatTraitement</content>
            </defaultValue>
          </textDataDefinition>
          <textDataDefinition className="java.lang.String" longText="true" name="codeSortieTache" transient="false"/>
          <textDataDefinition className="java.lang.String" longText="true" name="motif" transient="false"/>
          <textDataDefinition className="java.lang.String" longText="true" name="noteContenu" transient="false">
            <defaultValue expressionType="TYPE_VARIABLE" interpreter="" name="note" returnType="java.lang.String" id="6446110483318014546">
              <content>note</content>
            </defaultValue>
          </textDataDefinition>
          <dataDefinition className="java.lang.Boolean" name="hasNote" transient="false">
            <defaultValue expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="notNull" returnType="java.lang.Boolean" id="8599323736331536002">
              <content>note as boolean</content>
              <expression expressionType="TYPE_VARIABLE" name="note" returnType="java.lang.String" id="7488115617717226745">
                <content>note</content>
              </expression>
            </defaultValue>
          </dataDefinition>
          <dataDefinition className="java.lang.Float" name="poidsTache" transient="false">
            <defaultValue expressionType="TYPE_VARIABLE" interpreter="" name="poidsTacheTraitementMetier" returnType="java.lang.Float" id="7408443177479758174">
              <content>poidsTacheTraitementMetier</content>
            </defaultValue>
          </dataDefinition>
          <textDataDefinition className="java.lang.String" longText="true" name="nomPrenomsFiltered" transient="false">
            <defaultValue expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="accentHelper" returnType="java.lang.String" id="8861742916929504395">
              <content>import ch.vd.bpm.dperm.util.RemoveAccentHelper
return RemoveAccentHelper.removeAccents(nomPrenoms)</content>
              <expression expressionType="TYPE_VARIABLE" name="nomPrenoms" returnType="java.lang.String" id="4969825746605161893">
                <content>nomPrenoms</content>
              </expression>
            </defaultValue>
          </textDataDefinition>
          <dataDefinition className="java.lang.Boolean" name="taskAttributedByQuota" transient="false">
            <defaultValue expressionType="TYPE_CONSTANT" interpreter="" name="false" returnType="java.lang.Boolean" id="6139912400875348805">
              <content>false</content>
            </defaultValue>
          </dataDefinition>
          <dataDefinition className="java.util.Date" name="dateReception" transient="false">
            <defaultValue expressionType="TYPE_VARIABLE" interpreter="" name="dateReceptionDocument" returnType="java.util.Date" id="6001540558793401371">
              <content>dateReceptionDocument</content>
            </defaultValue>
          </dataDefinition>
          <dataDefinition className="java.lang.Long" name="taskBusinessId" transient="false"/>
          <textDataDefinition className="java.lang.String" longText="true" name="etapeManuelle" transient="false">
            <defaultValue expressionType="TYPE_CONSTANT" interpreter="" name="TRAITEMENT_METIER" returnType="java.lang.String" id="4738599197411535129">
              <content>TRAITEMENT_METIER</content>
            </defaultValue>
          </textDataDefinition>
          <textDataDefinition className="java.lang.String" longText="true" name="etatAvancement" transient="false"/>
          <dataDefinition className="java.lang.Long" name="version" transient="false">
            <defaultValue expressionType="TYPE_CONSTANT" interpreter="" name="1" returnType="java.lang.Long" id="8594149240783552570">
              <content>1</content>
            </defaultValue>
          </dataDefinition>
        </dataDefinitions>
        <operations>
          <operation operatorType="ASSIGNMENT">
            <leftOperand name="codeSortie" type="DATA"/>
            <rightOperand expressionType="TYPE_VARIABLE" interpreter="" name="codeSortieTache" returnType="java.lang.String" id="6829140044235741386">
              <content>codeSortieTache</content>
            </rightOperand>
          </operation>
          <operation operatorType="ASSIGNMENT">
            <leftOperand name="motifSortie" type="DATA"/>
            <rightOperand expressionType="TYPE_VARIABLE" interpreter="" name="motif" returnType="java.lang.String" id="6431040511815152914">
              <content>motif</content>
            </rightOperand>
          </operation>
          <operation operatorType="ASSIGNMENT">
            <leftOperand name="utilisateurTraitementMetierId" type="DATA"/>
            <rightOperand expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="taskAssigneeId" returnType="java.lang.Long" id="5952036983452848500">
              <content>taskAssigneeId</content>
              <expression expressionType="TYPE_ENGINE_CONSTANT" interpreter="" name="taskAssigneeId" returnType="java.lang.Long" id="7294181814229838781">
                <content>taskAssigneeId</content>
              </expression>
            </rightOperand>
          </operation>
          <operation operatorType="ASSIGNMENT">
            <leftOperand name="typeTacheTraitementMetier" type="DATA"/>
            <rightOperand expressionType="TYPE_VARIABLE" interpreter="" name="typeTache" returnType="java.lang.String" id="6737602419298737749">
              <content>typeTache</content>
            </rightOperand>
          </operation>
          <operation operatorType="ASSIGNMENT">
            <leftOperand name="groupeCandidatTraitement" type="DATA"/>
            <rightOperand expressionType="TYPE_VARIABLE" interpreter="" name="groupeCandidat" returnType="java.lang.String" id="6319433022059736103">
              <content>groupeCandidat</content>
            </rightOperand>
          </operation>
          <operation operatorType="ASSIGNMENT">
            <leftOperand name="visaUtilisateurTache" type="DATA"/>
            <rightOperand expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="visaUtilisateurTache" returnType="java.lang.String" id="8563454672329797782">
              <content>return taskAssigneeId&gt;0 ? apiAccessor.getIdentityAPI().getUser(taskAssigneeId).getUserName() : null</content>
              <expression expressionType="TYPE_ENGINE_CONSTANT" interpreter="" name="taskAssigneeId" returnType="java.lang.Long" id="8632107996099406587">
                <content>taskAssigneeId</content>
              </expression>
              <expression expressionType="TYPE_ENGINE_CONSTANT" interpreter="" name="apiAccessor" returnType="com.bonitasoft.engine.api.APIAccessor" id="4920263030909813069">
                <content>apiAccessor</content>
              </expression>
            </rightOperand>
          </operation>
          <operation operatorType="ASSIGNMENT">
            <leftOperand name="note" type="DATA"/>
            <rightOperand expressionType="TYPE_VARIABLE" interpreter="" name="noteContenu" returnType="java.lang.String" id="6869560176419535338">
              <content>noteContenu</content>
            </rightOperand>
          </operation>
        </operations>
        <boundaryEvents/>
      </userTask>
      <automaticTask id="-7390150140642673981" name="HistorisationAttribution">
        <incomingTransition idref="8036266156305369193"/>
        <outgoingTransition idref="3466313570673145685"/>
        <connector activationEvent="ON_ENTER" connectorId="HistoriqueDperm" failAction="FAIL" name="histoAttribution" version="1.5.0">
          <inputs>
            <input name="historique">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="true" returnType="java.lang.Boolean" id="9036836375615546756">
                <content>true</content>
              </expression>
            </input>
            <input name="jmsConnectionFactory">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="java:comp/env/activemq" returnType="java.lang.String" id="9165825958086199592">
                <content>java:comp/env/activemq</content>
              </expression>
            </input>
            <input name="codeOperation">
              <expression expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="TRAITEMENT_MET_ATTRIBUTION_TACHE" returnType="java.lang.String" id="4613228089016648314">
                <content>"TRAITEMENT_MET_ATTRIBUTION_TACHE_"+regleAttribution</content>
                <expression expressionType="TYPE_VARIABLE" name="regleAttribution" returnType="java.lang.String" id="6006785603151056850">
                  <content>regleAttribution</content>
                </expression>
              </expression>
            </input>
            <input name="esbApplication">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="esbNomApplication" returnType="java.lang.String" id="7088196432986154439">
                <content>esbNomApplication</content>
              </expression>
            </input>
            <input name="valeurAprès">
              <expression expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="utilisateurOUgroupeCandidatTraitement" returnType="java.lang.String" id="5999283144056331994">
                <content>visaUtilisateurTache ? visaUtilisateurTache : groupeCandidatTraitement</content>
                <expression expressionType="TYPE_VARIABLE" name="visaUtilisateurTache" returnType="java.lang.String" id="7098183012959070656">
                  <content>visaUtilisateurTache</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="groupeCandidatTraitement" returnType="java.lang.String" id="5054564760544953855">
                  <content>groupeCandidatTraitement</content>
                </expression>
              </expression>
            </input>
            <input name="identifiantSupervision">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="identifiantSupervision" returnType="java.lang.String" id="5122779868569380760">
                <content>identifiantSupervision</content>
              </expression>
            </input>
            <input name="evtProcessus">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="false" returnType="java.lang.Boolean" id="6806906439229938218">
                <content>false</content>
              </expression>
            </input>
            <input name="esbDomaine">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="esbNomDomaine" returnType="java.lang.String" id="6761790560648354624">
                <content>esbNomDomaine</content>
              </expression>
            </input>
            <input name="caracteristiques">
              <expression expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="map" returnType="java.util.Map" id="4698278015100546273">
                <content>def map = ["documentType":documentType,

	"documentSousType":documentSousType,

	"periodeFiscale":periodeFiscale,

	"dateReception":dateReceptionDocument,

	"numeroTiersIdentifie":numeroTiers,

	"nomPrenoms":nomPrenoms,

	"numeroAVS13":numeroAVS13,

	"dateNaissance":dateNaissance,

	"numeroOid" : numeroOid,

	"support":support]</content>
                <expression expressionType="TYPE_VARIABLE" name="numeroOid" returnType="java.lang.Integer" id="6237711119108076143">
                  <content>numeroOid</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="documentSousType" returnType="java.lang.String" id="6749595195014562111">
                  <content>documentSousType</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="documentType" returnType="java.lang.String" id="8137955188752346315">
                  <content>documentType</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="dateReceptionDocument" returnType="java.util.Date" id="8495769084367575658">
                  <content>dateReceptionDocument</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="support" returnType="java.lang.String" id="7450983815837149384">
                  <content>support</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="nomPrenoms" returnType="java.lang.String" id="7840460860587009185">
                  <content>nomPrenoms</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="dateNaissance" returnType="java.lang.Integer" id="8537382808795242531">
                  <content>dateNaissance</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="numeroTiers" returnType="java.lang.Integer" id="8687950081412298587">
                  <content>numeroTiers</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="numeroAVS13" returnType="java.lang.Long" id="5716694346278483991">
                  <content>numeroAVS13</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="periodeFiscale" returnType="java.lang.Integer" id="4823437136736767903">
                  <content>periodeFiscale</content>
                </expression>
              </expression>
            </input>
            <input name="typeTache">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="typeTacheTraitementMetier" returnType="java.lang.String" id="5079126315607472742">
                <content>typeTacheTraitementMetier</content>
              </expression>
            </input>
            <input name="codeApplication">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="BPMS" returnType="java.lang.String" id="8294465267920527914">
                <content>BPMS</content>
              </expression>
            </input>
            <input name="visaUtilisateur">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="visaUtilisateurSource" returnType="java.lang.String" id="6210774471990153347">
                <content>visaUtilisateurSource</content>
              </expression>
            </input>
            <input name="esbDestinationHistorique">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="integrerKpiDossierPermanent" returnType="java.lang.String" id="7230054197837119184">
                <content>integrerKpiDossierPermanent</content>
              </expression>
            </input>
          </inputs>
          <outputs/>
        </connector>
        <dataDefinitions/>
        <operations/>
        <boundaryEvents/>
      </automaticTask>
      <automaticTask id="-4876116241108304857" name="traiter TRAITEMENT_MET_TRAITER_MANUELLE">
        <incomingTransition idref="858423549146412443"/>
        <outgoingTransition idref="2882242925358501384"/>
        <connector activationEvent="ON_FINISH" connectorId="HistoriqueDperm" failAction="FAIL" name="Traiter" version="1.5.0">
          <inputs>
            <input name="jmsConnectionFactory">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="java:comp/env/activemq" returnType="java.lang.String" id="5375090720535463040">
                <content>java:comp/env/activemq</content>
              </expression>
            </input>
            <input name="historique">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="true" returnType="java.lang.Boolean" id="6841872747207534455">
                <content>true</content>
              </expression>
            </input>
            <input name="typeTache">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="typeTacheTraitementMetier" returnType="java.lang.String" id="8423250733625382385">
                <content>typeTacheTraitementMetier</content>
              </expression>
            </input>
            <input name="codeApplication">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="BPMS" returnType="java.lang.String" id="8001357228634165378">
                <content>BPMS</content>
              </expression>
            </input>
            <input name="codeOperation">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="TRAITEMENT_MET_TRAITER_MANUELLE" returnType="java.lang.String" id="7513482699199435204">
                <content>TRAITEMENT_MET_TRAITER_MANUELLE</content>
              </expression>
            </input>
            <input name="esbApplication">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="esbNomApplication" returnType="java.lang.String" id="5721509087943387463">
                <content>esbNomApplication</content>
              </expression>
            </input>
            <input name="visaUtilisateur">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="visaUtilisateurTache" returnType="java.lang.String" id="9012017341105343847">
                <content>visaUtilisateurTache</content>
              </expression>
            </input>
            <input name="esbDestinationHistorique">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="integrerKpiDossierPermanent" returnType="java.lang.String" id="7307085731346717700">
                <content>integrerKpiDossierPermanent</content>
              </expression>
            </input>
            <input name="identifiantSupervision">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="identifiantSupervision" returnType="java.lang.String" id="9008184059488794731">
                <content>identifiantSupervision</content>
              </expression>
            </input>
            <input name="esbDomaine">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="esbNomDomaine" returnType="java.lang.String" id="5010036899226174003">
                <content>esbNomDomaine</content>
              </expression>
            </input>
            <input name="evtProcessus">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="true" returnType="java.lang.Boolean" id="9101326164160810914">
                <content>true</content>
              </expression>
            </input>
            <input name="caracteristiques">
              <expression expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="map" returnType="java.util.Map" id="9143079107407576841">
                <content>def map = ["documentType":documentType,

	"documentSousType":documentSousType,

	"periodeFiscale":periodeFiscale,

	"dateReception":dateReceptionDocument,

	"numeroTiersIdentifie":numeroTiers,

	"nomPrenoms":nomPrenoms,

	"numeroAVS13":numeroAVS13,

	"dateNaissance":dateNaissance,

	"numeroOid" : numeroOid,

	"support":support]</content>
                <expression expressionType="TYPE_VARIABLE" name="numeroOid" returnType="java.lang.Integer" id="5321541534134519720">
                  <content>numeroOid</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="documentSousType" returnType="java.lang.String" id="5672005149916701353">
                  <content>documentSousType</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="nomPrenoms" returnType="java.lang.String" id="6899027711381439442">
                  <content>nomPrenoms</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="support" returnType="java.lang.String" id="5303044364544260874">
                  <content>support</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="documentType" returnType="java.lang.String" id="5874775346377635629">
                  <content>documentType</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="dateReceptionDocument" returnType="java.util.Date" id="8779764224808580955">
                  <content>dateReceptionDocument</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="dateNaissance" returnType="java.lang.Integer" id="6395446767302249447">
                  <content>dateNaissance</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="numeroTiers" returnType="java.lang.Integer" id="6205570118790369053">
                  <content>numeroTiers</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="numeroAVS13" returnType="java.lang.Long" id="5834327924451772863">
                  <content>numeroAVS13</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="periodeFiscale" returnType="java.lang.Integer" id="9175444394733356601">
                  <content>periodeFiscale</content>
                </expression>
              </expression>
            </input>
          </inputs>
          <outputs/>
        </connector>
        <dataDefinitions/>
        <operations/>
        <boundaryEvents/>
      </automaticTask>
      <automaticTask id="-7661396262429067357" name="Cloture TRAITEMENT_MET_DOCUMENT_TAXE">
        <incomingTransition idref="7907783763855819426"/>
        <outgoingTransition idref="2299557142480111676"/>
        <connector activationEvent="ON_FINISH" connectorId="HistoriqueDperm" failAction="FAIL" name="cloturer" version="1.5.0">
          <inputs>
            <input name="jmsConnectionFactory">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="java:comp/env/activemq" returnType="java.lang.String" id="8233597404360496757">
                <content>java:comp/env/activemq</content>
              </expression>
            </input>
            <input name="historique">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="true" returnType="java.lang.Boolean" id="7068140896552786590">
                <content>true</content>
              </expression>
            </input>
            <input name="typeTache">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="typeTacheTraitementMetier" returnType="java.lang.String" id="7802039809025383714">
                <content>typeTacheTraitementMetier</content>
              </expression>
            </input>
            <input name="codeApplication">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="BPMS" returnType="java.lang.String" id="6596726217488182120">
                <content>BPMS</content>
              </expression>
            </input>
            <input name="codeOperation">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="TRAITEMENT_MET_DOCUMENT_TAXE" returnType="java.lang.String" id="5483896421377482923">
                <content>TRAITEMENT_MET_DOCUMENT_TAXE</content>
              </expression>
            </input>
            <input name="esbApplication">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="esbNomApplication" returnType="java.lang.String" id="6798261585933965617">
                <content>esbNomApplication</content>
              </expression>
            </input>
            <input name="visaUtilisateur">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="visaUtilisateurTache" returnType="java.lang.String" id="8290096072904240213">
                <content>visaUtilisateurTache</content>
              </expression>
            </input>
            <input name="esbDestinationHistorique">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="integrerKpiDossierPermanent" returnType="java.lang.String" id="8902867667061012837">
                <content>integrerKpiDossierPermanent</content>
              </expression>
            </input>
            <input name="identifiantSupervision">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="identifiantSupervision" returnType="java.lang.String" id="8055070568313898263">
                <content>identifiantSupervision</content>
              </expression>
            </input>
            <input name="esbDomaine">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="esbNomDomaine" returnType="java.lang.String" id="5002674132310174190">
                <content>esbNomDomaine</content>
              </expression>
            </input>
            <input name="evtProcessus">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="true" returnType="java.lang.Boolean" id="8771871790685582576">
                <content>true</content>
              </expression>
            </input>
            <input name="caracteristiques">
              <expression expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="map" returnType="java.util.Map" id="6913907761263151006">
                <content>def map = ["documentType":documentType,

	"documentSousType":documentSousType,

	"periodeFiscale":periodeFiscale,

	"dateReception":dateReceptionDocument,

	"numeroTiersIdentifie":numeroTiers,

	"nomPrenoms":nomPrenoms,

	"numeroAVS13":numeroAVS13,

	"dateNaissance":dateNaissance,

	"numeroOid" : numeroOid,

	"support":support]</content>
                <expression expressionType="TYPE_VARIABLE" name="numeroOid" returnType="java.lang.Integer" id="7873079803398152136">
                  <content>numeroOid</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="documentSousType" returnType="java.lang.String" id="7025767186084081114">
                  <content>documentSousType</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="dateReceptionDocument" returnType="java.util.Date" id="7240910500226254655">
                  <content>dateReceptionDocument</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="nomPrenoms" returnType="java.lang.String" id="4867306608808156510">
                  <content>nomPrenoms</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="support" returnType="java.lang.String" id="8962966866543875763">
                  <content>support</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="documentType" returnType="java.lang.String" id="8816926264843840728">
                  <content>documentType</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="dateNaissance" returnType="java.lang.Integer" id="5931098494506845210">
                  <content>dateNaissance</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="numeroTiers" returnType="java.lang.Integer" id="6328001661391751618">
                  <content>numeroTiers</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="numeroAVS13" returnType="java.lang.Long" id="6528577719357682933">
                  <content>numeroAVS13</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="periodeFiscale" returnType="java.lang.Integer" id="5905551060604615287">
                  <content>periodeFiscale</content>
                </expression>
              </expression>
            </input>
          </inputs>
          <outputs/>
        </connector>
        <dataDefinitions/>
        <operations/>
        <boundaryEvents/>
      </automaticTask>
      <automaticTask id="-8456718405810970300" name="Demander Attribution tâche métier">
        <incomingTransition idref="129716143845886862"/>
        <outgoingTransition idref="5283198878804168443"/>
        <connector activationEvent="ON_FINISH" connectorId="EsbVdJmsSendRequest" failAction="FAIL" name="demanderAttribution" version="1.0.0">
          <inputs>
            <input name="serviceReplyTo">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="esbDestinationRetourBonita" returnType="java.lang.String" id="4803602396305290438">
                <content>esbDestinationRetourBonita</content>
              </expression>
            </input>
            <input name="body">
              <expression expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="bodyDemandeAttribution" returnType="java.lang.Object" id="8542276399718803387">
                <content>import ch.vd.bpm.dperm.util.DpermValidator;

def writer = new StringWriter()
def xml = new groovy.xml.MarkupBuilder(writer)

def typesAssuj = [ordinaryResidentType:"VAUDOIS_ORDINAIRE",
	pureWithholdingType:"SOURCIER_PUR",
	mixedWithholding137Par1Type:"SOURCIER_MIXTE1",
	mixedWithholding137Par2Type:"SOURCIER_MIXTE2",
	indigentType:"INDIGENT",
	otherCantonType:"HORS_CANTON",
	foreignCountryType:"HORS_SUISSE",
	expenditureBasedType:"VAUDOIS_DEPENSE",
	swissDiplomatType:"DIPLOMATE_SUISSE"]

xml.'elementsAttributionTache'(
		'xmlns':'http://www.vd.ch/fiscalite/dperm/administration/attribution/4'
) {
		'etapeManuelle'("TRAITEMENT_METIER")
		'typeDocument'(documentType)
		'sousTypeDocument'(documentSousType)
		'typeImpot'(typeImpot)
		if(typeTaxation) 'typeTaxation'(typeTaxation)
		if(etatTaxation) 'etatTaxation'(etatTaxation)
		if(codeSegment) 'codeSegment'(codeSegment)
		if(doublonTypeTaxationPrecedente) {
			'doublon' {
				'typeTaxationPrecedente'(doublonTypeTaxationPrecedente)
			}
		}
		'assujettissement' {
			def tpyeAssuj = typesAssuj[typeAssujettissement]
				'typeAssujettissement' (tpyeAssuj)
				if(assujettissement360!=null) 'assujettissement360'(assujettissement360)
				if(contribuableSourcierMixte!=null) 'contribuableSourcierMixte'(contribuableSourcierMixte)
			}
		
		/*
		if(assujettissement360 || contribuableSourcierMixte) {
			'assujettissement'{
				if(assujettissement360!=null) 'assujettissement360'(assujettissement360)
				if(contribuableSourcierMixte!=null) 'contribuableSourcierMixte'(contribuableSourcierMixte)
			}
		}
*/
		if(releveFiscalBancaire) 'releveFiscalBancaire'(releveFiscalBancaire)
		
		if(controleIA) 'controleIA'(controleIA)
		if(numeroOid) 	'numeroOid'(numeroOid)
		
		'deces'(dateDeces!=null &amp;&amp; dateDeces &gt;0)
}

def xmlStr = writer.toString()
DpermValidator.validate(xmlStr)
return xmlStr</content>
                <expression expressionType="TYPE_VARIABLE" name="documentType" returnType="java.lang.String" id="7652103636072435762">
                  <content>documentType</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="doublonTypeTaxationPrecedente" returnType="java.lang.String" id="9181966170099997445">
                  <content>doublonTypeTaxationPrecedente</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="etatTaxation" returnType="java.lang.String" id="5878978964630709043">
                  <content>etatTaxation</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="controleIA" returnType="java.lang.Boolean" id="5890881539169761994">
                  <content>controleIA</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="codeSegment" returnType="java.lang.String" id="5088729560580002559">
                  <content>codeSegment</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="typeTaxation" returnType="java.lang.String" id="8222666282391627977">
                  <content>typeTaxation</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="numeroOid" returnType="java.lang.Integer" id="5828907784349346283">
                  <content>numeroOid</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="documentSousType" returnType="java.lang.String" id="7855699735958675842">
                  <content>documentSousType</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="contribuableSourcierMixte" returnType="java.lang.Boolean" id="8304586125732474275">
                  <content>contribuableSourcierMixte</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="dateDeces" returnType="java.lang.Integer" id="5065631120982693310">
                  <content>dateDeces</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="typeImpot" returnType="java.lang.String" id="7121812132043796895">
                  <content>typeImpot</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="assujettissement360" returnType="java.lang.Boolean" id="6181202356640431420">
                  <content>assujettissement360</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="typeAssujettissement" returnType="java.lang.String" id="7293874656866952240">
                  <content>typeAssujettissement</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="releveFiscalBancaire" returnType="java.lang.Boolean" id="8536937770558307203">
                  <content>releveFiscalBancaire</content>
                </expression>
              </expression>
            </input>
            <input name="application">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="esbNomApplication" returnType="java.lang.String" id="4851724558080858467">
                <content>esbNomApplication</content>
              </expression>
            </input>
            <input name="contentAsUrl">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="true" returnType="java.lang.Boolean" id="5098117875504404893">
                <content>true</content>
              </expression>
            </input>
            <input name="domaine">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="esbNomDomaine" returnType="java.lang.String" id="8963515137152474315">
                <content>esbNomDomaine</content>
              </expression>
            </input>
            <input name="contexte">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="demandeAttributionMetier" returnType="java.lang.String" id="6244215964989675803">
                <content>demandeAttributionMetier</content>
              </expression>
            </input>
            <input name="messageName">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="AttributionMetier" returnType="java.lang.String" id="4864030472564457238">
                <content>AttributionMetier</content>
              </expression>
            </input>
            <input name="destination">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="esbDestinationDemandeAttribution" returnType="java.lang.String" id="9146250509619092022">
                <content>esbDestinationDemandeAttribution</content>
              </expression>
            </input>
            <input name="businessUser">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="bpm" returnType="java.lang.String" id="8724104874287421547">
                <content>bpm</content>
              </expression>
            </input>
            <input name="connectionFactoryJndiName">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="java:comp/env/activemq" returnType="java.lang.String" id="4954184227852812786">
                <content>java:comp/env/activemq</content>
              </expression>
            </input>
            <input name="bonitaInstance">
              <expression expressionType="TYPE_PARAMETER" interpreter="" name="esbBonitaInstance" returnType="java.lang.String" id="6292821421801306214">
                <content>esbBonitaInstance</content>
              </expression>
            </input>
            <input name="businessId">
              <expression expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="ATTR-MET-CTB-PF-" returnType="java.lang.String" id="5370472990823387310">
                <content>"ATTR-MET-"+numeroTiers+"-"+periodeFiscale+"-"</content>
                <expression expressionType="TYPE_VARIABLE" name="numeroTiers" returnType="java.lang.Integer" id="6705449440318731393">
                  <content>numeroTiers</content>
                </expression>
                <expression expressionType="TYPE_VARIABLE" name="periodeFiscale" returnType="java.lang.Integer" id="7588225212891068511">
                  <content>periodeFiscale</content>
                </expression>
              </expression>
            </input>
            <input name="targetFlowNode">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="RecevoirAttributionMetier" returnType="java.lang.String" id="8110234223155539108">
                <content>RecevoirAttributionMetier</content>
              </expression>
            </input>
          </inputs>
          <outputs>
            <operation operatorType="ASSIGNMENT">
              <leftOperand name="messageCorrelationId" type="DATA"/>
              <rightOperand expressionType="TYPE_INPUT" interpreter="" name="correlationId" returnType="java.lang.String" id="5933184166428785588">
                <content>correlationId</content>
              </rightOperand>
            </operation>
          </outputs>
        </connector>
        <dataDefinitions/>
        <operations/>
        <boundaryEvents/>
      </automaticTask>
      <automaticTask id="-6053231319704948221" name="Recevoir attribution">
        <incomingTransition idref="1013255267931435607"/>
        <outgoingTransition idref="3392752396061618272"/>
        <connector activationEvent="ON_ENTER" connectorId="reponseAttribution" failAction="FAIL" name="reponseAttributionMetier" version="1.0.0">
          <inputs>
            <input name="messageContentUrl">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="lastMessageContent" returnType="java.lang.String" id="6351051469429460668">
                <content>lastMessageContent</content>
              </expression>
            </input>
          </inputs>
          <outputs>
            <operation operatorType="ASSIGNMENT">
              <leftOperand name="poidsTacheTraitementMetier" type="DATA"/>
              <rightOperand expressionType="TYPE_INPUT" interpreter="" name="poidsTache" returnType="java.lang.Float" id="8198404146636179404">
                <content>poidsTache</content>
              </rightOperand>
            </operation>
            <operation operatorType="ASSIGNMENT">
              <leftOperand name="typeTacheTraitementMetier" type="DATA"/>
              <rightOperand expressionType="TYPE_INPUT" interpreter="" name="typeTache" returnType="java.lang.String" id="8060065946731337083">
                <content>typeTache</content>
              </rightOperand>
            </operation>
            <operation operatorType="ASSIGNMENT">
              <leftOperand name="groupeCandidatTraitement" type="DATA"/>
              <rightOperand expressionType="TYPE_INPUT" interpreter="" name="codePot" returnType="java.lang.String" id="4618363694259357947">
                <content>codePot</content>
              </rightOperand>
            </operation>
          </outputs>
        </connector>
        <dataDefinitions/>
        <operations/>
        <boundaryEvents/>
      </automaticTask>
      <automaticTask id="-8932868884221801937" name="Déterminer attribution métier">
        <incomingTransition idref="3392752396061618272"/>
        <outgoingTransition idref="8036266156305369193"/>
        <connector activationEvent="ON_ENTER" connectorId="reglesAttributionMetier" failAction="FAIL" name="determinerAttributionMetier" version="1.1.1">
          <inputs>
            <input name="typeTache">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="typeTacheTraitementMetier" returnType="java.lang.String" id="8989253811073982353">
                <content>typeTacheTraitementMetier</content>
              </expression>
            </input>
            <input name="visaDernierModificateur">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="visaPreferentiel" returnType="java.lang.String" id="8396945909564783991">
                <content>visaPreferentiel</content>
              </expression>
            </input>
            <input name="numeroTiers">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="numeroTiers" returnType="java.lang.Integer" id="8655841180594576120">
                <content>numeroTiers</content>
              </expression>
            </input>
            <input name="visaDossierReserve">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="visaDossierReserve" returnType="java.lang.String" id="7295041893078924659">
                <content>visaDossierReserve</content>
              </expression>
            </input>
            <input name="ignorerRegleC">
              <expression expressionType="TYPE_CONSTANT" interpreter="" name="true" returnType="java.lang.Boolean" id="6771918815984377797">
                <content>true</content>
              </expression>
            </input>
            <input name="groupeCandidat">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="groupeCandidatTraitement" returnType="java.lang.String" id="9042968248228269285">
                <content>groupeCandidatTraitement</content>
              </expression>
            </input>
            <input name="periodeFiscale">
              <expression expressionType="TYPE_VARIABLE" interpreter="" name="periodeFiscale" returnType="java.lang.Integer" id="5587732227173410575">
                <content>periodeFiscale</content>
              </expression>
            </input>
          </inputs>
          <outputs>
            <operation operatorType="ASSIGNMENT">
              <leftOperand name="utilisateurTraitementMetierId" type="DATA"/>
              <rightOperand expressionType="TYPE_INPUT" interpreter="" name="utilisateurMetierId" returnType="java.lang.Long" id="8559451528484077256">
                <content>utilisateurMetierId</content>
              </rightOperand>
            </operation>
            <operation operatorType="ASSIGNMENT">
              <leftOperand name="groupeCandidatTraitement" type="DATA"/>
              <rightOperand expressionType="TYPE_INPUT" interpreter="" name="groupeCandidat" returnType="java.lang.String" id="8194108041807546362">
                <content>groupeCandidat</content>
              </rightOperand>
            </operation>
            <operation operatorType="ASSIGNMENT">
              <leftOperand name="regleAttribution" type="DATA"/>
              <rightOperand expressionType="TYPE_INPUT" interpreter="" name="regleAttribution" returnType="java.lang.String" id="5604707855438544850">
                <content>regleAttribution</content>
              </rightOperand>
            </operation>
          </outputs>
        </connector>
        <dataDefinitions>
          <textDataDefinition className="java.lang.String" longText="true" name="groupeCandidat" transient="false"/>
        </dataDefinitions>
        <operations>
          <operation operatorType="ASSIGNMENT">
            <leftOperand name="visaUtilisateurTache" type="DATA"/>
            <rightOperand expressionType="TYPE_READ_ONLY_SCRIPT" interpreter="GROOVY" name="getUsername" returnType="java.lang.String" id="6281133954918891671">
              <content>import org.slf4j.LoggerFactory;

def username = null

if( utilisateurTraitementMetierId!= null) {
	try {
		username = apiAccessor.getIdentityAPI().getUser(utilisateurTraitementMetierId).getUserName()
	} catch(Exception ex) {
		LoggerFactory.getLogger("ch.vd.bpm.dperm.groovy").warn("impossible de trouver le username pour l'id "+utilisateurTraitementMetierId,ex);
	}
}

return username</content>
              <expression expressionType="TYPE_ENGINE_CONSTANT" interpreter="" name="apiAccessor" returnType="com.bonitasoft.engine.api.APIAccessor" id="5820798745531771212">
                <content>apiAccessor</content>
              </expression>
              <expression expressionType="TYPE_VARIABLE" name="utilisateurTraitementMetierId" returnType="java.lang.Long" id="5378671038932003290">
                <content>utilisateurTraitementMetierId</content>
              </expression>
            </rightOperand>
          </operation>
        </operations>
        <boundaryEvents/>
      </automaticTask>
      <gateway gatewayType="EXCLUSIVE" id="-7650460117796767812" name="Traitement ?">
        <incomingTransition idref="6371906930711968907"/>
        <outgoingTransition idref="858423549146412443"/>
        <defaultTransition idref="7907783763855819426"/>
      </gateway>
      <startEvent id="-4837761989316226414" interrupting="true" name="Début traitement">
        <outgoingTransition idref="129716143845886862"/>
      </startEvent>
      <intermediateCatchEvent description="attribution" id="-8383969093528301277" interrupting="true" name="RecevoirAttributionMetier">
        <incomingTransition idref="5283198878804168443"/>
        <outgoingTransition idref="1013255267931435607"/>
        <catchMessageEventTrigger name="AttributionMetier">
          <correlation>
            <key expressionType="TYPE_CONSTANT" interpreter="" name="correlationId" returnType="java.lang.String" id="8418003795480844304">
              <content>correlationId</content>
            </key>
            <value expressionType="TYPE_VARIABLE" interpreter="" name="messageCorrelationId" returnType="java.lang.String" id="5410125842670992492">
              <content>messageCorrelationId</content>
            </value>
          </correlation>
          <operation operatorType="ASSIGNMENT">
            <leftOperand name="lastMessageContent" type="DATA"/>
            <rightOperand expressionType="TYPE_VARIABLE" interpreter="" name="messageContentUrl" returnType="java.lang.String" id="6865526523564521892">
              <content>messageContentUrl</content>
            </rightOperand>
          </operation>
        </catchMessageEventTrigger>
      </intermediateCatchEvent>
      <endEvent id="-5255675401303113632" name="Fin traité">
        <incomingTransition idref="2882242925358501384"/>
      </endEvent>
      <endEvent id="-8839777733939990055" name="Fin cloture">
        <incomingTransition idref="2299557142480111676"/>
      </endEvent>
    </flowNodes>
  </flowElements>
  <dependencies>
    <parameters>
      <parameter name="versionProcessAttribution" type="java.lang.String">
        <description/>
      </parameter>
      <parameter name="esbNomApplication" type="java.lang.String">
        <description/>
      </parameter>
      <parameter name="esbNomDomaine" type="java.lang.String">
        <description/>
      </parameter>
      <parameter name="esbDestinationRetourBonita" type="java.lang.String">
        <description/>
      </parameter>
      <parameter name="visaUtilisateurSource" type="java.lang.String">
        <description/>
      </parameter>
      <parameter name="esbBonitaInstance" type="java.lang.String">
        <description/>
      </parameter>
      <parameter name="esbDestinationDemandeAttribution" type="java.lang.String">
        <description/>
      </parameter>
    </parameters>
    <actors>
      <actor name="Taxateur DI">
        <description/>
      </actor>
    </actors>
  </dependencies>
</processDefinition>

<?xml version="1.0" encoding="UTF-8"?>
<def:processDefinition xmlns:def="http://www.bonitasoft.org/ns/process/client/7.2" name="Invoice ValidationV7" version="7.2">
    <description />
    <displayDescription />
    <stringIndexes>
        <stringIndex index="1" label="department" />
        <stringIndex index="2" />
        <stringIndex index="3" />
        <stringIndex index="4" />
        <stringIndex index="5" />
    </stringIndexes>
    <flowElements>
        <transitions>
            <transition id="8794421614698345065" name="5143229421650366501_-&gt;_6547796660298625759" source="5143229421650366501" target="6547796660298625759" />
            <transition id="6921379676675356727" name="7441296378704966523_-&gt;_7863057901391050267" source="7441296378704966523" target="7863057901391050267" />
            <transition id="3550324194541351227" name="7245009479926885705_-&gt;_7135455442750273880" source="7245009479926885705" target="7135455442750273880" />
            <transition id="506007889422235356" name="8565391256545207971_-&gt;_5563657923473787274" source="8565391256545207971" target="5563657923473787274" />
            <transition id="7637128807599094555" name="8009991342183420404_-&gt;_6634194108631502763" source="8009991342183420404" target="6634194108631502763" />
            <transition id="8528676271155397212" name="6689104371089416843_-&gt;_8565391256545207971" source="6689104371089416843" target="8565391256545207971" />
            <transition id="1596940576459701352" name="5563657923473787274_-&gt;_8009991342183420404" source="5563657923473787274" target="8009991342183420404">
                <condition expressionType="TYPE_VARIABLE" id="3833452669213129743" interpreter="" name="lastApproval" returnType="java.lang.Boolean">
                    <content>lastApproval</content>
                </condition>
            </transition>
            <transition id="7094606553931821170" name="5563657923473787274_-&gt;_5143229421650366501" source="5563657923473787274" target="5143229421650366501" />
            <transition id="5752217157309910333" name="7023345139099408055_-&gt;_7441296378704966523" source="7023345139099408055" target="7441296378704966523" />
            <transition id="1664184595907394427" name="7146661999664874435_-&gt;_6689104371089416843" source="7146661999664874435" target="6689104371089416843">
                <condition expressionType="TYPE_READ_ONLY_SCRIPT" id="5929037032971390056" interpreter="GROOVY" name="greaterThanPriceLimit" returnType="java.lang.Boolean">
                    <content>invoice.getInvoiceAmount() &gt; priceLimit</content>
                    <expression expressionType="TYPE_PARAMETER" id="2544367066851856182" name="priceLimit" returnType="java.lang.Double">
                        <content>priceLimit</content>
                    </expression>
                    <expression expressionType="TYPE_BUSINESS_DATA" id="1382604229637093244" name="invoice" returnType="com.company.model.Invoice">
                        <content>invoice</content>
                    </expression>
                </condition>
            </transition>
            <transition id="6619477364372555218" name="7863057901391050267_-&gt;_7146661999664874435" source="7863057901391050267" target="7146661999664874435">
                <condition expressionType="TYPE_VARIABLE" id="2131749463737060524" interpreter="" name="firstLevelApproved" returnType="java.lang.Boolean">
                    <content>firstLevelApproved</content>
                </condition>
            </transition>
            <transition id="8909307998548872439" name="7863057901391050267_-&gt;_5143229421650366501" source="7863057901391050267" target="5143229421650366501" />
            <transition id="8873294523393590186" name="7146661999664874435_-&gt;_8009991342183420404" source="7146661999664874435" target="8009991342183420404" />
            <transition id="2002270635405689790" name="7135455442750273880_-&gt;_7023345139099408055" source="7135455442750273880" target="7023345139099408055" />
        </transitions>
        <connectors>
            <connector activationEvent="ON_ENTER" connectorId="scripting-groovy-script" failAction="FAIL" name="initAttach" version="1.0.0">
                <inputs>
                    <input name="script">
                        <expression expressionType="TYPE_CONSTANT" id="2640754325507885291" interpreter="" name="init" returnType="java.lang.String">
                            <content>import org.bonitasoft.engine.bpm.document.DocumentValue;


                                return new DocumentValue(attachDoc.getContent(), "text/plain", attachDoc.getFileName());
                            </content>
                        </expression>
                    </input>
                    <input name="variables">
                        <expression expressionType="TYPE_LIST" id="3303049714302403715" name="Table of expression containing the following expressions: [(attachDoc,attachDoc,)]." returnType="java.util.List">
                            <content>Table of expression containing the following expressions: [(attachDoc,attachDoc,)].</content>
                            <expression expressionType="TYPE_LIST" id="4967743332415194586" name="Table of expression containing the following expressions: [(attachDoc,attachDoc,)]._0" returnType="java.util.List">
                                <content>Table of expression containing the following expressions: [(attachDoc,attachDoc,)]._0</content>
                                <expression expressionType="TYPE_CONSTANT" id="2010513796419503721" interpreter="" name="attachDoc" returnType="java.lang.String">
                                    <content>attachDoc</content>
                                </expression>
                                <expression expressionType="TYPE_CONTRACT_INPUT" id="371410346960504716" interpreter="" name="attachDoc" returnType="org.bonitasoft.engine.bpm.contract.FileInputValue">
                                    <content>attachDoc</content>
                                </expression>
                            </expression>
                        </expression>
                    </input>
                </inputs>
                <outputs>
                    <operation operatorType="ASSIGNMENT">
                        <leftOperand name="attachment" type="DOCUMENT" />
                        <rightOperand expressionType="TYPE_READ_ONLY_SCRIPT" id="8470120071958842166" interpreter="GROOVY" name="result" returnType="org.bonitasoft.engine.bpm.document.DocumentValue">
                            <content>return result;</content>
                            <expression expressionType="TYPE_INPUT" id="3388809166173485003" name="result" returnType="java.lang.Object">
                                <content>result</content>
                            </expression>
                        </rightOperand>
                    </operation>
                </outputs>
            </connector>
            <connector activationEvent="ON_ENTER" connectorId="scripting-groovy-script" failAction="FAIL" name="initOther" version="1.0.0">
                <inputs>
                    <input name="script">
                        <expression expressionType="TYPE_CONSTANT" id="8948524226370686957" interpreter="" name="init" returnType="java.lang.String">
                            <content>import org.bonitasoft.engine.bpm.document.DocumentValue;


                                return new DocumentValue(otherDoc.getContent(), "text/plain", otherDoc.getFileName());
                            </content>
                        </expression>
                    </input>
                    <input name="variables">
                        <expression expressionType="TYPE_LIST" id="3127461204251031702" name="Table of expression containing the following expressions: [(otherDoc,otherDoc,)]." returnType="java.util.List">
                            <content>Table of expression containing the following expressions: [(otherDoc,otherDoc,)].</content>
                            <expression expressionType="TYPE_LIST" id="8738706088839658811" name="Table of expression containing the following expressions: [(otherDoc,otherDoc,)]._0" returnType="java.util.List">
                                <content>Table of expression containing the following expressions: [(otherDoc,otherDoc,)]._0</content>
                                <expression expressionType="TYPE_CONSTANT" id="8020117255310624516" interpreter="" name="otherDoc" returnType="java.lang.String">
                                    <content>otherDoc</content>
                                </expression>
                                <expression expressionType="TYPE_CONTRACT_INPUT" id="914310289194529736" interpreter="" name="otherDoc" returnType="org.bonitasoft.engine.bpm.contract.FileInputValue">
                                    <content>otherDoc</content>
                                </expression>
                            </expression>
                        </expression>
                    </input>
                </inputs>
                <outputs>
                    <operation operatorType="ASSIGNMENT">
                        <leftOperand name="otherdoc" type="DOCUMENT" />
                        <rightOperand expressionType="TYPE_READ_ONLY_SCRIPT" id="1564288883607516157" interpreter="GROOVY" name="result" returnType="org.bonitasoft.engine.bpm.document.DocumentValue">
                            <content>return result;</content>
                            <expression expressionType="TYPE_INPUT" id="302519178394055441" name="result" returnType="java.lang.Object">
                                <content>result</content>
                            </expression>
                        </rightOperand>
                    </operation>
                </outputs>
            </connector>
        </connectors>
        <businessDataDefinitions>
            <businessDataDefinition className="com.company.model.Invoice" multiple="false" name="invoice">
                <description />
                <defaultValue expressionType="TYPE_READ_ONLY_SCRIPT" id="8871479679518028110" interpreter="GROOVY" name="Init" returnType="com.company.model.Invoice">
                    <content>import com.company.model.Invoice;


                        Invoice invoice = new Invoice();


                        invoice.setEmail(invoiceInvoice.get("email"));

                        invoice.setDepartment(invoiceInvoice.get("department"));

                        invoice.setInvoiceId(invoiceInvoice.get("invoiceId"));

                        invoice.setFirstName(invoiceInvoice.get("firstName"));

                        invoice.setCustomerName(invoiceInvoice.get("customerName"));

                        invoice.setLastName(invoiceInvoice.get("lastName"));

                        invoice.setInvoiceAmount(invoiceInvoice.get("invoiceAmount"));

                        invoice.setInvoiceDate(invoiceInvoice.get("invoiceDate"));

                        invoice.setProcessInstanceId(processInstanceId);

                        invoice.setStatus("In Progress");


                        return invoice;


                    </content>
                    <expression expressionType="TYPE_ENGINE_CONSTANT" id="2939054125684341529" interpreter="" name="processInstanceId" returnType="java.lang.Long">
                        <content>processInstanceId</content>
                    </expression>
                    <expression expressionType="TYPE_CONTRACT_INPUT" id="9183639060295403058" name="invoiceInvoice" returnType="java.util.Map">
                        <content>invoiceInvoice</content>
                    </expression>
                </defaultValue>
            </businessDataDefinition>
        </businessDataDefinitions>
        <dataDefinitions>
            <dataDefinition className="java.lang.Boolean" name="firstLevelApproved" transient="false" />
            <dataDefinition className="java.lang.Boolean" name="lastApproval" transient="false" />
        </dataDefinitions>
        <documentDefinitions>
            <documentDefinition mimeType="application/octet-stream" name="attachment">
                <description />
            </documentDefinition>
            <documentDefinition mimeType="application/octet-stream" name="otherdoc">
                <description />
            </documentDefinition>
        </documentDefinitions>
        <documentListDefinitions />
        <endEvent id="6547796660298625759" name="Invoice rejected">
            <incomingTransition>8794421614698345065</incomingTransition>
            <terminateEventTrigger />
        </endEvent>
        <endEvent id="6634194108631502763" name="Invoice approved">
            <incomingTransition>7637128807599094555</incomingTransition>
            <terminateEventTrigger />
        </endEvent>
        <startEvent id="7245009479926885705" interrupting="true" name="Submit Invoice">
            <outgoingTransition>3550324194541351227</outgoingTransition>
        </startEvent>
        <gateway gatewayType="EXCLUSIVE" id="5563657923473787274" name="Has been approved ?">
            <incomingTransition>506007889422235356</incomingTransition>
            <outgoingTransition>1596940576459701352</outgoingTransition>
            <defaultTransition>7094606553931821170</defaultTransition>
        </gateway>
        <gateway gatewayType="EXCLUSIVE" id="7146661999664874435" name="Is greater than default limit ?">
            <incomingTransition>6619477364372555218</incomingTransition>
            <outgoingTransition>1664184595907394427</outgoingTransition>
            <defaultTransition>8873294523393590186</defaultTransition>
        </gateway>
        <gateway gatewayType="EXCLUSIVE" id="7863057901391050267" name="Is approved ?">
            <incomingTransition>6921379676675356727</incomingTransition>
            <outgoingTransition>6619477364372555218</outgoingTransition>
            <defaultTransition>8909307998548872439</defaultTransition>
        </gateway>
        <userTask actorName="Approver2" expectedDuration="3600000" id="8565391256545207971" name="Level Two Validation" priority="NORMAL">
            <description>This task is for the level 2 approver to review and approve the invoice. On approval or rejection an approval notification will be sent to the employee</description>
            <incomingTransition>8528676271155397212</incomingTransition>
            <outgoingTransition>506007889422235356</outgoingTransition>
            <dataDefinitions>
                <dataDefinition className="java.lang.Boolean" name="validation" transient="false" />
            </dataDefinitions>
            <operations>
                <operation operatorType="ASSIGNMENT">
                    <leftOperand name="lastApproval" type="DATA" />
                    <rightOperand expressionType="TYPE_CONTRACT_INPUT" id="1949107212318126105" interpreter="" name="finalApproval" returnType="java.lang.Boolean">
                        <content>finalApproval</content>
                    </rightOperand>
                </operation>
                <operation operator="setStatus:java.lang.String" operatorType="JAVA_METHOD">
                    <leftOperand name="invoice" type="BUSINESS_DATA" />
                    <rightOperand expressionType="TYPE_READ_ONLY_SCRIPT" id="8494651739307555801" interpreter="GROOVY" name="setFinalStatus" returnType="java.lang.String">
                        <content>if (finalApproval==false)

                            {

                            return "Level 2 Approved";

                            }

                            else

                            {

                            return "Rejected";

                            }
                        </content>
                        <expression expressionType="TYPE_CONTRACT_INPUT" id="4247520160625806125" name="finalApproval" returnType="java.lang.Boolean">
                            <content>finalApproval</content>
                        </expression>
                    </rightOperand>
                </operation>
            </operations>
            <boundaryEvents />
            <userFilter name="User in the lane" userFilterId="single-user" version="1.0.0">
                <inputs>
                    <input name="userId">
                        <expression expressionType="TYPE_READ_ONLY_SCRIPT" id="8616192170114040995" interpreter="GROOVY" name="getUserByName" returnType="java.lang.Long">
                            <content>apiAccessor.getIdentityAPI().getUserByUserName("jan.fisher").getId();</content>
                            <expression expressionType="TYPE_ENGINE_CONSTANT" id="1532310761660005969" interpreter="" name="apiAccessor" returnType="com.bonitasoft.engine.api.APIAccessor">
                                <content>apiAccessor</content>
                            </expression>
                        </expression>
                    </input>
                </inputs>
            </userFilter>
            <contract>
                <inputDefinitions>
                    <inputDefinition multiple="false" name="finalApproval" type="BOOLEAN">
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                </inputDefinitions>
            </contract>
            <context>
                <contextEntry key="invoice_ref">
                    <expression expressionType="TYPE_BUSINESS_DATA_REFERENCE" id="648779963364426690" name="invoice" returnType="org.bonitasoft.engine.business.data.BusinessDataReference">
                        <content>invoice</content>
                    </expression>
                </contextEntry>
                <contextEntry key="attachment_ref">
                    <expression expressionType="TYPE_DOCUMENT" id="648235286062020766" name="attachment" returnType="org.bonitasoft.engine.bpm.document.Document">
                        <content>attachment</content>
                    </expression>
                </contextEntry>
                <contextEntry key="otherdoc_ref">
                    <expression expressionType="TYPE_DOCUMENT" id="8065344541322557112" name="otherdoc" returnType="org.bonitasoft.engine.bpm.document.Document">
                        <content>otherdoc</content>
                    </expression>
                </contextEntry>
            </context>
        </userTask>
        <automaticTask id="6689104371089416843" name="Set Status to Level 2 Validation">
            <description>This task is for the level 2 approver to review and approve the invoice. On approval or rejection an approval notification will be sent to the employee</description>
            <incomingTransition>1664184595907394427</incomingTransition>
            <outgoingTransition>8528676271155397212</outgoingTransition>
            <connector activationEvent="ON_ENTER" connectorId="scripting-groovy-script" failAction="FAIL" name="setStatusLevel2" version="1.0.0">
                <inputs>
                    <input name="script">
                        <expression expressionType="TYPE_CONSTANT" id="5622001834147625399" interpreter="" name="setStatus2" returnType="java.lang.String">
                            <content>import com.company.model.Invoice;


                                invoice.setStatus("Level 2 Approval");
                            </content>
                        </expression>
                    </input>
                    <input name="variables">
                        <expression expressionType="TYPE_LIST" id="5952216179530708602" name="Table of expression containing the following expressions: [(invoice,invoice,)]." returnType="java.util.List">
                            <content>Table of expression containing the following expressions: [(invoice,invoice,)].</content>
                            <expression expressionType="TYPE_LIST" id="5492854339696544566" name="Table of expression containing the following expressions: [(invoice,invoice,)]._0" returnType="java.util.List">
                                <content>Table of expression containing the following expressions: [(invoice,invoice,)]._0</content>
                                <expression expressionType="TYPE_CONSTANT" id="7584894817497560331" interpreter="" name="invoice" returnType="java.lang.String">
                                    <content>invoice</content>
                                </expression>
                                <expression expressionType="TYPE_BUSINESS_DATA" id="6473385038300691655" interpreter="" name="invoice" returnType="com.company.model.Invoice">
                                    <content>invoice</content>
                                </expression>
                            </expression>
                        </expression>
                    </input>
                </inputs>
                <outputs />
            </connector>
            <dataDefinitions>
                <dataDefinition className="java.lang.Boolean" name="validation" transient="false" />
            </dataDefinitions>
            <operations />
            <boundaryEvents />
        </automaticTask>
        <automaticTask id="8009991342183420404" name="Notification Approved">
            <incomingTransition>8873294523393590186</incomingTransition>
            <incomingTransition>1596940576459701352</incomingTransition>
            <outgoingTransition>7637128807599094555</outgoingTransition>
            <connector activationEvent="ON_FINISH" connectorId="email" failAction="FAIL" name="Connector Email Approved" version="1.0.0">
                <inputs>
                    <input name="message">
                        <expression expressionType="TYPE_READ_ONLY_SCRIPT" id="6152493298916542274" interpreter="GROOVY" name="body" returnType="java.lang.String">
                            <content>"""&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;&lt;html xmlns:def="http://www.w3.org/1999/xhtml"&gt;&lt;head&gt;&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;&lt;title&gt;Bonitasoft&lt;/title&gt;&lt;style&gt;

                                .ReadMsgBody{width: 100%;background-color:#F2F2F2;}

                                .ExternalClass{width: 100%;}&lt;/style&gt;&lt;/head&gt;&lt;body style="background-color:#F2F2F2;font-family:Arial, Helvetica, sans-serif;font-size:14px;color:#003952;"&gt;&lt;center&gt;&lt;table align="center" cellpadding="0" cellspacing="0" id="tablemain" width="600" style="border-collapse:collapse;padding:0;margin:0px auto;" bgcolor="#FFFFFF" border="0"&gt;&lt;tr valign="top"&gt;&lt;!--HEADER--&gt;&lt;td width="350" bgcolor="#FFFFFF"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/blue_green_yellow_350_43.png" width="350" height="43" border="0" style="background-color:#F2F2F2;"/&gt;&lt;/td&gt;&lt;!--LOGO--&gt;&lt;td width="250" rowspan="2"&gt;&lt;a href="http://www.bonitasoft.com/?utm_medium=email&amp;utm_source=loopfuse&amp;utm_campaign=the_campaign_name&amp;utm_content=top_logo" target="_blank"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/logo_top_250_95.png" alt="Bonita" height="95" width="250" border="0" title="Bonitasoft Logo" style="background-color:#F2F2F2;"/&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan="2" bgcolor="#FFFFFF"&gt;&lt;table width="600" align="left" cellpadding="0" cellspacing="0" border="0"&gt;&lt;tr&gt;&lt;td colspan="3"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_10.png" height="10" width="10" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td width="20"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_20.png" height="20" width="20" border="0"/&gt;&lt;/td&gt;&lt;td width="560" style="text-align:left;"&gt;&lt;!--TEXT 1--&gt;&lt;p style="text-align:left;"&gt;&lt;br/&gt;&lt;strong&gt;Madam/Sir """ + invoice.getFirstName() + """&lt;/strong&gt;,&lt;br/&gt;&lt;/p&gt;&lt;/td&gt;&lt;td width="20"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_20.png" height="20" width="20" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan="3"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_10.png" height="10" width="10" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan="2" bgcolor="#FFFFFF"&gt;&lt;table width="600" align="left" cellpadding="0" cellspacing="0" border="0"&gt;&lt;tr&gt;&lt;td colspan="3"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_10.png" height="10" width="10" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td width="20"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_20.png" height="20" width="20" border="0"/&gt;&lt;/td&gt;&lt;td width="560" style="text-align:left;"&gt;&lt;!--TEXT 2--&gt;&lt;p style="text-align:left;"&gt;Your invoice,&lt;strong&gt; ID N° """ + invoice.getInvoiceId() + """&lt;/strong&gt;, for department """ + invoice.getDepartment() + """ for an amount of """ + invoice.getInvoiceAmount()+ """€ has been &lt;strong&gt;approved&lt;/strong&gt;.&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;

                                Thank you&lt;br/&gt;&lt;/p&gt;&lt;/td&gt;&lt;td width="20"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_20.png" height="20" width="20" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan="3"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_10.png" height="10" width="10" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td bgcolor="#FFFFFF" colspan="2"&gt;&lt;table width="600" align="left" cellpadding="0" cellspacing="0" border="0"&gt;&lt;tr&gt;&lt;td colspan="3"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_10.png" height="10" width="10" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td width="20"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_20.png" height="20" width="20" border="0"/&gt;&lt;/td&gt;&lt;td width="260" style="text-align:left;"&gt;&lt;!-- SIGNATURE --&gt;&lt;p style="text-align:left;"&gt;

                                Best Regards,&lt;br/&gt;

                                Yours sincerely,&lt;br/&gt;&lt;br/&gt;&lt;a href="http://www.bonitasoft.com/?utm_medium=email&amp;utm_source=loopfuse&amp;utm_campaign=the_campaign_name&amp;utm_content=bottom_logo" target="_blank"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/primary_logo.png" alt="Bonitasoft" height="30" width="120" border="0" title="Bonitasoft Logo"/&gt;&lt;/a&gt;&lt;br/&gt;

                                The Bonitasoft Validation Team

                                &lt;/p&gt;&lt;/td&gt;&lt;td width="420"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_20.png" height="20" width="20" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan="3"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_10.png" height="10" width="10" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td width="600" colspan="2"&gt;&lt;!-- FOOTER --&gt;&lt;table width="600" align="left" cellpadding="0" cellspacing="0" bgcolor="#E31837" border="0"&gt;&lt;tr&gt;&lt;td width="20"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_20.png" height="30" width="20" border="0"/&gt;&lt;/td&gt;&lt;td width="30"&gt;&lt;a href="http://www.twitter.com/bonitasoft" target="_blank"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/twitter_30.png" alt="twittter icon" height="30" width="30" border="0" title="Twitter" /&gt;&lt;/a&gt;&lt;/td&gt;&lt;td width="30"&gt;&lt;a href="http://www.facebook.com/bonitasoftbpm" target="_blank"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/facebook_30.png" alt="twittter icon" height="30" width="30" border="0" title="Twitter" /&gt;&lt;/a&gt;&lt;/td&gt;&lt;td width="30"&gt;&lt;a href="http://www.youtube.com/bonitasoft" target="_blank"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/youtube_30.png" alt="youtube icon" height="30" width="30" border="0" title="Youtube" /&gt;&lt;/a&gt;&lt;/td&gt;&lt;td width="30"&gt;&lt;a href="http://www.slideshare.net/bonitasoft" target="_blank"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/slideshare_30.png" alt="slideshare icon" height="30" width="30" border="0" title="Slideshare" /&gt;&lt;/a&gt;&lt;/td&gt;&lt;td width="30"&gt;&lt;a href="http://www.linkedin.com/groups?gid=3182097" target="_blank"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/linkedin_30.png" alt="linkedin icon" height="30" width="30" border="0" title="Linkedin" /&gt;&lt;/a&gt;&lt;/td&gt;&lt;td width="20"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_20.png" height="30" width="20" border="0"/&gt;&lt;/td&gt;&lt;td width="320"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/copyright_320_30.png" height="30" width="320" border="0"/&gt;&lt;/td&gt;&lt;td width="70"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/beefficient_70_30.png" height="30" width="70" border="0"/&gt;&lt;/td&gt;&lt;td width="20"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_20.png" height="30" width="20" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;"""

                            </content>
                            <expression expressionType="TYPE_BUSINESS_DATA" id="1507666182074287569" name="invoice" returnType="com.company.model.Invoice">
                                <content>invoice</content>
                            </expression>
                        </expression>
                    </input>
                    <input name="to">
                        <expression expressionType="TYPE_JAVA_METHOD_CALL" id="75730749118856303" interpreter="" name="invoice - com.company.model.Invoice#getEmail" returnType="java.lang.String">
                            <content>getEmail</content>
                            <expression expressionType="TYPE_BUSINESS_DATA" id="2244610974483332850" name="invoice" returnType="com.company.model.Invoice">
                                <content>invoice</content>
                            </expression>
                        </expression>
                    </input>
                    <input name="smtpPort">
                        <expression expressionType="TYPE_CONSTANT" id="6410395766771135154" interpreter="" name="465" returnType="java.lang.Integer">
                            <content>465</content>
                        </expression>
                    </input>
                    <input name="starttlsSupport">
                        <expression expressionType="TYPE_CONSTANT" id="1770188629653996059" interpreter="" name="false" returnType="java.lang.Boolean">
                            <content>false</content>
                        </expression>
                    </input>
                    <input name="sslSupport">
                        <expression expressionType="TYPE_CONSTANT" id="716304401876405116" interpreter="" name="true" returnType="java.lang.Boolean">
                            <content>true</content>
                        </expression>
                    </input>
                    <input name="smtpHost">
                        <expression expressionType="TYPE_PARAMETER" id="2526824668141305077" interpreter="" name="smtp_host" returnType="java.lang.String">
                            <content>smtp_host</content>
                        </expression>
                    </input>
                    <input name="subject">
                        <expression expressionType="TYPE_CONSTANT" id="3749401550868691468" interpreter="" name="Notification Approved" returnType="java.lang.String">
                            <content>Notification Approved</content>
                        </expression>
                    </input>
                    <input name="userName">
                        <expression expressionType="TYPE_PARAMETER" id="6167809057186627091" interpreter="" name="userMail" returnType="java.lang.String">
                            <content>userMail</content>
                        </expression>
                    </input>
                    <input name="html">
                        <expression expressionType="TYPE_CONSTANT" id="6064734533793038346" interpreter="" name="true" returnType="java.lang.Boolean">
                            <content>true</content>
                        </expression>
                    </input>
                    <input name="attachments">
                        <expression expressionType="TYPE_LIST" id="2515131355619112474" name="List of expression containing the following expressions: (attachment,)." returnType="java.util.List">
                            <content>List of expression containing the following expressions: (attachment,).</content>
                            <expression expressionType="TYPE_CONSTANT" id="3040856171718462422" name="attachment" returnType="java.lang.String">
                                <content>attachment</content>
                            </expression>
                        </expression>
                    </input>
                    <input name="from">
                        <expression expressionType="TYPE_JAVA_METHOD_CALL" id="3473404224824785485" interpreter="" name="invoice - com.company.model.Invoice#getEmail" returnType="java.lang.String">
                            <content>getEmail</content>
                            <expression expressionType="TYPE_BUSINESS_DATA" id="8903388933343103326" name="invoice" returnType="com.company.model.Invoice">
                                <content>invoice</content>
                            </expression>
                        </expression>
                    </input>
                    <input name="password">
                        <expression expressionType="TYPE_PARAMETER" id="5260148575322225778" interpreter="" name="emailPassword" returnType="java.lang.String">
                            <content>emailPassword</content>
                        </expression>
                    </input>
                </inputs>
                <outputs />
            </connector>
            <dataDefinitions />
            <operations>
                <operation operator="setStatus:java.lang.String" operatorType="JAVA_METHOD">
                    <leftOperand name="invoice" type="BUSINESS_DATA" />
                    <rightOperand expressionType="TYPE_CONSTANT" id="3267887885588253344" interpreter="" name="Approved - Closed" returnType="java.lang.String">
                        <content>Approved - Closed</content>
                    </rightOperand>
                </operation>
            </operations>
            <boundaryEvents />
        </automaticTask>
        <automaticTask id="5143229421650366501" name="Notification Rejected">
            <incomingTransition>8909307998548872439</incomingTransition>
            <incomingTransition>7094606553931821170</incomingTransition>
            <outgoingTransition>8794421614698345065</outgoingTransition>
            <connector activationEvent="ON_FINISH" connectorId="email" failAction="FAIL" name="Connector Email rejected" version="1.0.0">
                <inputs>
                    <input name="message">
                        <expression expressionType="TYPE_READ_ONLY_SCRIPT" id="103902908211248386" interpreter="GROOVY" name="body" returnType="java.lang.String">
                            <content>"""&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;&lt;html xmlns:def="http://www.w3.org/1999/xhtml"&gt;&lt;head&gt;&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;&lt;title&gt;Bonitasoft&lt;/title&gt;&lt;style&gt;

                                .ReadMsgBody{width: 100%;background-color:#F2F2F2;}

                                .ExternalClass{width: 100%;}&lt;/style&gt;&lt;/head&gt;&lt;body style="background-color:#F2F2F2;font-family:Arial, Helvetica, sans-serif;font-size:14px;color:#003952;"&gt;&lt;center&gt;&lt;table align="center" cellpadding="0" cellspacing="0" id="tablemain" width="600" style="border-collapse:collapse;padding:0;margin:0px auto;" bgcolor="#FFFFFF" border="0"&gt;&lt;tr valign="top"&gt;&lt;!--HEADER--&gt;&lt;td width="350" bgcolor="#FFFFFF"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/blue_green_yellow_350_43.png" width="350" height="43" border="0" style="background-color:#F2F2F2;"/&gt;&lt;/td&gt;&lt;!--LOGO--&gt;&lt;td width="250" rowspan="2"&gt;&lt;a href="http://www.bonitasoft.com/?utm_medium=email&amp;utm_source=loopfuse&amp;utm_campaign=the_campaign_name&amp;utm_content=top_logo" target="_blank"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/logo_top_250_95.png" alt="Bonita" height="95" width="250" border="0" title="Bonitasoft Logo" style="background-color:#F2F2F2;"/&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan="2" bgcolor="#FFFFFF"&gt;&lt;table width="600" align="left" cellpadding="0" cellspacing="0" border="0"&gt;&lt;tr&gt;&lt;td colspan="3"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_10.png" height="10" width="10" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td width="20"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_20.png" height="20" width="20" border="0"/&gt;&lt;/td&gt;&lt;td width="560" style="text-align:left;"&gt;&lt;!--TEXT 1--&gt;&lt;p style="text-align:left;"&gt;&lt;br/&gt;&lt;strong&gt;Madam/Sir """ + invoice.getFirstName() + """&lt;/strong&gt;,&lt;br/&gt;&lt;/p&gt;&lt;/td&gt;&lt;td width="20"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_20.png" height="20" width="20" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan="3"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_10.png" height="10" width="10" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan="2" bgcolor="#FFFFFF"&gt;&lt;table width="600" align="left" cellpadding="0" cellspacing="0" border="0"&gt;&lt;tr&gt;&lt;td colspan="3"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_10.png" height="10" width="10" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td width="20"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_20.png" height="20" width="20" border="0"/&gt;&lt;/td&gt;&lt;td width="560" style="text-align:left;"&gt;&lt;!--TEXT 2--&gt;&lt;p style="text-align:left;"&gt;Your invoice,&lt;strong&gt; ID N° """ + invoice.getInvoiceId() + """&lt;/strong&gt;, for department """ + invoice.getDepartment() + """ for an amount of """ + invoice.getInvoiceAmount()+ """€ has been &lt;strong&gt;rejected&lt;/strong&gt;.&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;

                                Thank you&lt;br/&gt;&lt;/p&gt;&lt;/td&gt;&lt;td width="20"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_20.png" height="20" width="20" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan="3"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_10.png" height="10" width="10" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td bgcolor="#FFFFFF" colspan="2"&gt;&lt;table width="600" align="left" cellpadding="0" cellspacing="0" border="0"&gt;&lt;tr&gt;&lt;td colspan="3"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_10.png" height="10" width="10" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td width="20"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_20.png" height="20" width="20" border="0"/&gt;&lt;/td&gt;&lt;td width="260" style="text-align:left;"&gt;&lt;!-- SIGNATURE --&gt;&lt;p style="text-align:left;"&gt;

                                Best Regards,&lt;br/&gt;

                                Yours sincerely,&lt;br/&gt;&lt;br/&gt;&lt;a href="http://www.bonitasoft.com/?utm_medium=email&amp;utm_source=loopfuse&amp;utm_campaign=the_campaign_name&amp;utm_content=bottom_logo" target="_blank"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/primary_logo.png" alt="Bonitasoft" height="30" width="120" border="0" title="Bonitasoft Logo"/&gt;&lt;/a&gt;&lt;br/&gt;

                                The Bonitasoft Validation Team

                                &lt;/p&gt;&lt;/td&gt;&lt;td width="420"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_20.png" height="20" width="20" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan="3"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_10.png" height="10" width="10" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td width="600" colspan="2"&gt;&lt;!-- FOOTER --&gt;&lt;table width="600" align="left" cellpadding="0" cellspacing="0" bgcolor="#E31837" border="0"&gt;&lt;tr&gt;&lt;td width="20"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_20.png" height="30" width="20" border="0"/&gt;&lt;/td&gt;&lt;td width="30"&gt;&lt;a href="http://www.twitter.com/bonitasoft" target="_blank"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/twitter_30.png" alt="twittter icon" height="30" width="30" border="0" title="Twitter" /&gt;&lt;/a&gt;&lt;/td&gt;&lt;td width="30"&gt;&lt;a href="http://www.facebook.com/bonitasoftbpm" target="_blank"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/facebook_30.png" alt="twittter icon" height="30" width="30" border="0" title="Twitter" /&gt;&lt;/a&gt;&lt;/td&gt;&lt;td width="30"&gt;&lt;a href="http://www.youtube.com/bonitasoft" target="_blank"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/youtube_30.png" alt="youtube icon" height="30" width="30" border="0" title="Youtube" /&gt;&lt;/a&gt;&lt;/td&gt;&lt;td width="30"&gt;&lt;a href="http://www.slideshare.net/bonitasoft" target="_blank"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/slideshare_30.png" alt="slideshare icon" height="30" width="30" border="0" title="Slideshare" /&gt;&lt;/a&gt;&lt;/td&gt;&lt;td width="30"&gt;&lt;a href="http://www.linkedin.com/groups?gid=3182097" target="_blank"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/linkedin_30.png" alt="linkedin icon" height="30" width="30" border="0" title="Linkedin" /&gt;&lt;/a&gt;&lt;/td&gt;&lt;td width="20"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_20.png" height="30" width="20" border="0"/&gt;&lt;/td&gt;&lt;td width="320"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/copyright_320_30.png" height="30" width="320" border="0"/&gt;&lt;/td&gt;&lt;td width="70"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/beefficient_70_30.png" height="30" width="70" border="0"/&gt;&lt;/td&gt;&lt;td width="20"&gt;&lt;img src="http://www.bonitasoft.com/landing/img/spacer_20.png" height="30" width="20" border="0"/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;"""

                            </content>
                            <expression expressionType="TYPE_BUSINESS_DATA" id="1279597675025119764" name="invoice" returnType="com.company.model.Invoice">
                                <content>invoice</content>
                            </expression>
                        </expression>
                    </input>
                    <input name="to">
                        <expression expressionType="TYPE_JAVA_METHOD_CALL" id="1490600330154560218" interpreter="" name="invoice - com.company.model.Invoice#getEmail" returnType="java.lang.String">
                            <content>getEmail</content>
                            <expression expressionType="TYPE_BUSINESS_DATA" id="1271837637924863476" name="invoice" returnType="com.company.model.Invoice">
                                <content>invoice</content>
                            </expression>
                        </expression>
                    </input>
                    <input name="smtpPort">
                        <expression expressionType="TYPE_CONSTANT" id="6748812315504626537" interpreter="" name="465" returnType="java.lang.Integer">
                            <content>465</content>
                        </expression>
                    </input>
                    <input name="starttlsSupport">
                        <expression expressionType="TYPE_CONSTANT" id="2023482898572031087" interpreter="" name="false" returnType="java.lang.Boolean">
                            <content>false</content>
                        </expression>
                    </input>
                    <input name="sslSupport">
                        <expression expressionType="TYPE_CONSTANT" id="1431652070468700573" interpreter="" name="true" returnType="java.lang.Boolean">
                            <content>true</content>
                        </expression>
                    </input>
                    <input name="smtpHost">
                        <expression expressionType="TYPE_PARAMETER" id="6912437122242988470" interpreter="" name="smtp_host" returnType="java.lang.String">
                            <content>smtp_host</content>
                        </expression>
                    </input>
                    <input name="subject">
                        <expression expressionType="TYPE_CONSTANT" id="7311124349849455373" interpreter="" name="Notification rejected" returnType="java.lang.String">
                            <content>Notification rejected</content>
                        </expression>
                    </input>
                    <input name="userName">
                        <expression expressionType="TYPE_PARAMETER" id="4434423896805559641" interpreter="" name="userMail" returnType="java.lang.String">
                            <content>userMail</content>
                        </expression>
                    </input>
                    <input name="html">
                        <expression expressionType="TYPE_CONSTANT" id="1579149321253336968" interpreter="" name="true" returnType="java.lang.Boolean">
                            <content>true</content>
                        </expression>
                    </input>
                    <input name="attachments">
                        <expression expressionType="TYPE_LIST" id="7330859169304560678" name="List of expression containing the following expressions: (attachment,)." returnType="java.util.List">
                            <content>List of expression containing the following expressions: (attachment,).</content>
                            <expression expressionType="TYPE_CONSTANT" id="6723947939141928648" name="attachment" returnType="java.lang.String">
                                <content>attachment</content>
                            </expression>
                        </expression>
                    </input>
                    <input name="from">
                        <expression expressionType="TYPE_JAVA_METHOD_CALL" id="5522022853256889526" interpreter="" name="invoice - com.company.model.Invoice#getEmail" returnType="java.lang.String">
                            <content>getEmail</content>
                            <expression expressionType="TYPE_BUSINESS_DATA" id="3443867924656142867" name="invoice" returnType="com.company.model.Invoice">
                                <content>invoice</content>
                            </expression>
                        </expression>
                    </input>
                    <input name="password">
                        <expression expressionType="TYPE_PARAMETER" id="6764273827555593346" interpreter="" name="emailPassword" returnType="java.lang.String">
                            <content>emailPassword</content>
                        </expression>
                    </input>
                </inputs>
                <outputs />
            </connector>
            <dataDefinitions />
            <operations>
                <operation operator="setStatus:java.lang.String" operatorType="JAVA_METHOD">
                    <leftOperand name="invoice" type="BUSINESS_DATA" />
                    <rightOperand expressionType="TYPE_CONSTANT" id="6290139690870394216" interpreter="" name="Rejected - Closed" returnType="java.lang.String">
                        <content>Rejected - Closed</content>
                    </rightOperand>
                </operation>
            </operations>
            <boundaryEvents />
        </automaticTask>
        <userTask actorName="Approver1" expectedDuration="3600000" id="7441296378704966523" name="Level One Validation" priority="NORMAL">
            <description>This task is for the level 1 approver to review and approve the invoice. On approval or rejection an approval notification will be sent to the employee</description>
            <incomingTransition>5752217157309910333</incomingTransition>
            <outgoingTransition>6921379676675356727</outgoingTransition>
            <dataDefinitions>
                <dataDefinition className="java.lang.Double" name="invoiceAmount" transient="false" />
            </dataDefinitions>
            <operations>
                <operation operatorType="ASSIGNMENT">
                    <leftOperand name="firstLevelApproved" type="DATA" />
                    <rightOperand expressionType="TYPE_CONTRACT_INPUT" id="4560747997799559545" interpreter="" name="firstLevelApproval" returnType="java.lang.Boolean">
                        <content>firstLevelApproval</content>
                    </rightOperand>
                </operation>
                <operation operator="setStatus:java.lang.String" operatorType="JAVA_METHOD">
                    <leftOperand name="invoice" type="BUSINESS_DATA" />
                    <rightOperand expressionType="TYPE_READ_ONLY_SCRIPT" id="6275766413597785781" interpreter="GROOVY" name="newStatus" returnType="java.lang.String">
                        <content>if (firstLevelApproved==true)

                            {

                            return "Level 1 Approved";

                            }

                            else

                            {

                            return "Rejected";

                            }
                        </content>
                        <expression expressionType="TYPE_VARIABLE" id="8783495364342204907" name="firstLevelApproved" returnType="java.lang.Boolean">
                            <content>firstLevelApproved</content>
                        </expression>
                    </rightOperand>
                </operation>
            </operations>
            <boundaryEvents />
            <userFilter name="User in the lane" userFilterId="single-user" version="1.0.0">
                <inputs>
                    <input name="userId">
                        <expression expressionType="TYPE_READ_ONLY_SCRIPT" id="7432037708917262291" interpreter="GROOVY" name="getUserIdByName" returnType="java.lang.Long">
                            <content>apiAccessor.getIdentityAPI().getUserByUserName("william.jobs").getId();</content>
                            <expression expressionType="TYPE_ENGINE_CONSTANT" id="5525103240315518253" interpreter="" name="apiAccessor" returnType="com.bonitasoft.engine.api.APIAccessor">
                                <content>apiAccessor</content>
                            </expression>
                        </expression>
                    </input>
                </inputs>
            </userFilter>
            <contract>
                <inputDefinitions>
                    <inputDefinition multiple="false" name="firstLevelApproval" type="BOOLEAN">
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                </inputDefinitions>
            </contract>
            <context>
                <contextEntry key="invoice_ref">
                    <expression expressionType="TYPE_BUSINESS_DATA_REFERENCE" id="3633385491007386163" name="invoice" returnType="org.bonitasoft.engine.business.data.BusinessDataReference">
                        <content>invoice</content>
                    </expression>
                </contextEntry>
                <contextEntry key="attachment_ref">
                    <expression expressionType="TYPE_DOCUMENT" id="7512706540095780269" name="attachment" returnType="org.bonitasoft.engine.bpm.document.Document">
                        <content>attachment</content>
                    </expression>
                </contextEntry>
                <contextEntry key="otherdoc_ref">
                    <expression expressionType="TYPE_DOCUMENT" id="3100626817215185175" name="otherdoc" returnType="org.bonitasoft.engine.bpm.document.Document">
                        <content>otherdoc</content>
                    </expression>
                </contextEntry>
            </context>
        </userTask>
        <automaticTask id="7023345139099408055" name="Set Status to Level 1 Approval">
            <description>This task is for the level 1 approver to review and approve the invoice. On approval or rejection an approval notification will be sent to the employee</description>
            <incomingTransition>2002270635405689790</incomingTransition>
            <outgoingTransition>5752217157309910333</outgoingTransition>
            <connector activationEvent="ON_ENTER" connectorId="scripting-groovy-script" failAction="FAIL" name="setStatus" version="1.0.0">
                <inputs>
                    <input name="script">
                        <expression expressionType="TYPE_CONSTANT" id="8602453331688702758" interpreter="" name="setStatusLevel1" returnType="java.lang.String">
                            <content>import com.company.model.Invoice;


                                invoice.setStatus("Level 1 Approval");
                            </content>
                        </expression>
                    </input>
                    <input name="variables">
                        <expression expressionType="TYPE_LIST" id="6571011256450830114" name="Table of expression containing the following expressions: [(invoice,invoice,)]." returnType="java.util.List">
                            <content>Table of expression containing the following expressions: [(invoice,invoice,)].</content>
                            <expression expressionType="TYPE_LIST" id="5353056124226783005" name="Table of expression containing the following expressions: [(invoice,invoice,)]._0" returnType="java.util.List">
                                <content>Table of expression containing the following expressions: [(invoice,invoice,)]._0</content>
                                <expression expressionType="TYPE_CONSTANT" id="3008947465729521345" interpreter="" name="invoice" returnType="java.lang.String">
                                    <content>invoice</content>
                                </expression>
                                <expression expressionType="TYPE_BUSINESS_DATA" id="3721379573177301474" interpreter="" name="invoice" returnType="com.company.model.Invoice">
                                    <content>invoice</content>
                                </expression>
                            </expression>
                        </expression>
                    </input>
                </inputs>
                <outputs />
            </connector>
            <dataDefinitions>
                <dataDefinition className="java.lang.Double" name="invoiceAmount" transient="false" />
            </dataDefinitions>
            <operations />
            <boundaryEvents />
        </automaticTask>
        <automaticTask id="7135455442750273880" name="Update process data">
            <incomingTransition>3550324194541351227</incomingTransition>
            <outgoingTransition>2002270635405689790</outgoingTransition>
            <dataDefinitions />
            <operations>
                <operation operator="setProcessInstanceId:java.lang.Long" operatorType="JAVA_METHOD">
                    <leftOperand name="invoice" type="BUSINESS_DATA" />
                    <rightOperand expressionType="TYPE_READ_ONLY_SCRIPT" id="3861370795162910667" interpreter="GROOVY" name="sdfsdf" returnType="java.lang.Long">
                        <content>processInstanceId</content>
                        <expression expressionType="TYPE_ENGINE_CONSTANT" id="5086885037858375386" interpreter="" name="processInstanceId" returnType="java.lang.Long">
                            <content>processInstanceId</content>
                        </expression>
                    </rightOperand>
                </operation>
            </operations>
            <boundaryEvents />
        </automaticTask>
    </flowElements>
    <actors>
        <actor name="Employee">
            <description>This is an example of actor that is mapped to any ACME users</description>
        </actor>
        <actor name="Approver2">
            <description />
        </actor>
        <actor name="Approver1">
            <description />
        </actor>
    </actors>
    <parameters>
        <parameter name="priceLimit" type="java.lang.Double">
            <description />
        </parameter>
        <parameter name="emailPassword" type="java.lang.String">
            <description />
        </parameter>
        <parameter name="userMail" type="java.lang.String">
            <description />
        </parameter>
        <parameter name="smtp_host" type="java.lang.String">
            <description />
        </parameter>
        <parameter name="targetURL" type="java.lang.String">
            <description />
        </parameter>
    </parameters>
    <actorInitiator>Employee</actorInitiator>
    <contract>
        <inputDefinitions>
            <inputDefinition multiple="false" name="invoiceInvoice">
                <inputDefinitions>
                    <inputDefinition multiple="false" name="invoiceId" type="TEXT">
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                    <inputDefinition multiple="false" name="firstName" type="TEXT">
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                    <inputDefinition multiple="false" name="lastName" type="TEXT">
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                    <inputDefinition multiple="false" name="email" type="TEXT">
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                    <inputDefinition multiple="false" name="department" type="TEXT">
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                    <inputDefinition multiple="false" name="invoiceAmount" type="DECIMAL">
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                    <inputDefinition multiple="false" name="invoiceDate" type="DATE">
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                    <inputDefinition multiple="false" name="customerName" type="TEXT">
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                </inputDefinitions>
                <inputDefinitions>
                    <inputDefinition multiple="false" name="invoiceId" type="TEXT">
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                    <inputDefinition multiple="false" name="firstName" type="TEXT">
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                    <inputDefinition multiple="false" name="lastName" type="TEXT">
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                    <inputDefinition multiple="false" name="email" type="TEXT">
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                    <inputDefinition multiple="false" name="department" type="TEXT">
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                    <inputDefinition multiple="false" name="invoiceAmount" type="DECIMAL">
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                    <inputDefinition multiple="false" name="invoiceDate" type="DATE">
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                    <inputDefinition multiple="false" name="customerName" type="TEXT">
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                </inputDefinitions>
            </inputDefinition>
            <inputDefinition multiple="false" name="attachDoc" type="FILE">
                <inputDefinitions>
                    <inputDefinition multiple="false" name="filename" type="TEXT">
                        <description>Name of the file</description>
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                    <inputDefinition multiple="false" name="content" type="BYTE_ARRAY">
                        <description>Content of the file</description>
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                </inputDefinitions>
                <inputDefinitions>
                    <inputDefinition multiple="false" name="filename" type="TEXT">
                        <description>Name of the file</description>
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                    <inputDefinition multiple="false" name="content" type="BYTE_ARRAY">
                        <description>Content of the file</description>
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                </inputDefinitions>
            </inputDefinition>
            <inputDefinition multiple="false" name="otherDoc" type="FILE">
                <inputDefinitions>
                    <inputDefinition multiple="false" name="filename" type="TEXT">
                        <description>Name of the file</description>
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                    <inputDefinition multiple="false" name="content" type="BYTE_ARRAY">
                        <description>Content of the file</description>
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                </inputDefinitions>
                <inputDefinitions>
                    <inputDefinition multiple="false" name="filename" type="TEXT">
                        <description>Name of the file</description>
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                    <inputDefinition multiple="false" name="content" type="BYTE_ARRAY">
                        <description>Content of the file</description>
                        <inputDefinitions />
                        <inputDefinitions />
                    </inputDefinition>
                </inputDefinitions>
            </inputDefinition>
        </inputDefinitions>
    </contract>
    <context>
        <contextEntry key="invoice_ref">
            <expression expressionType="TYPE_BUSINESS_DATA_REFERENCE" id="3428561741078245425" name="invoice" returnType="org.bonitasoft.engine.business.data.BusinessDataReference">
                <content>invoice</content>
            </expression>
        </contextEntry>
        <contextEntry key="attachment_ref">
            <expression expressionType="TYPE_DOCUMENT" id="6181139356684667117" name="attachment" returnType="org.bonitasoft.engine.bpm.document.Document">
                <content>attachment</content>
            </expression>
        </contextEntry>
        <contextEntry key="otherdoc_ref">
            <expression expressionType="TYPE_DOCUMENT" id="8630842670696936914" name="otherdoc" returnType="org.bonitasoft.engine.bpm.document.Document">
                <content>otherdoc</content>
            </expression>
        </contextEntry>
    </context>
</def:processDefinition>
